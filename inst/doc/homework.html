<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Fanglin Bao" />

<meta name="date" content="2020-12-19" />

<title>homework</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">Fanglin Bao</h4>
<h4 class="date">2020-12-19</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>This file includes all my homework answers. The functions used in this files can be found in the <em>StatComp20009</em> packege.</p>
</div>
<div id="homework-0" class="section level2">
<h2>Homework 0</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(StatComp20009)</span></code></pre></div>
</div>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p>The 1st example should contain texts and at least one ﬁgure.</p>
</div>
<div id="answer1" class="section level2">
<h2>Answer1</h2>
<p>Let a=3<span class="math inline">\(\pi\)</span> ,we draw a sin(ax) and a cos(ax) line from 0 to 1.And we add the line y=0 to each figure.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">64</span><span class="op">/</span><span class="dv">64</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>y1 &lt;-<span class="st"> </span><span class="kw">sin</span>(<span class="dv">3</span><span class="op">*</span>pi<span class="op">*</span>x)</span>
<span id="cb2-3"><a href="#cb2-3"></a>y2 &lt;-<span class="st"> </span><span class="kw">cos</span>(<span class="dv">3</span><span class="op">*</span>pi<span class="op">*</span>x)</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="kw">plot</span>(x, y1, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;sin(ax)&quot;</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="st">&quot;sin(ax)&quot;</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span> ,<span class="dt">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">plot</span>(x, y2, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;cos(ax)&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="st">&quot;cos(ax)&quot;</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span> ,<span class="dt">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>The 2nd example should contains texts and at least one table.</p>
</div>
<div id="answer2" class="section level2">
<h2>Answer2</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">library</span>(xtable)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw">data</span>(tli)</span>
<span id="cb4-3"><a href="#cb4-3"></a>tli.table &lt;-<span class="st"> </span><span class="kw">xtable</span>(tli[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>, ])</span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="kw">print</span>(tli.table, <span class="dt">type =</span> <span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<!-- html table generated in R 4.0.2 by xtable 1.8-4 package -->
<!-- Sat Dec 19 14:29:43 2020 -->
<table border="1">
<tr>
<th>
</th>
<th>
grade
</th>
<th>
sex
</th>
<th>
disadvg
</th>
<th>
ethnicty
</th>
<th>
tlimth
</th>
</tr>
<tr>
<td align="right">
1
</td>
<td align="right">
6
</td>
<td>
M
</td>
<td>
YES
</td>
<td>
HISPANIC
</td>
<td align="right">
43
</td>
</tr>
<tr>
<td align="right">
2
</td>
<td align="right">
7
</td>
<td>
M
</td>
<td>
NO
</td>
<td>
BLACK
</td>
<td align="right">
88
</td>
</tr>
<tr>
<td align="right">
3
</td>
<td align="right">
5
</td>
<td>
F
</td>
<td>
YES
</td>
<td>
HISPANIC
</td>
<td align="right">
34
</td>
</tr>
<tr>
<td align="right">
4
</td>
<td align="right">
3
</td>
<td>
M
</td>
<td>
YES
</td>
<td>
HISPANIC
</td>
<td align="right">
65
</td>
</tr>
<tr>
<td align="right">
5
</td>
<td align="right">
8
</td>
<td>
M
</td>
<td>
YES
</td>
<td>
WHITE
</td>
<td align="right">
75
</td>
</tr>
<tr>
<td align="right">
6
</td>
<td align="right">
5
</td>
<td>
M
</td>
<td>
NO
</td>
<td>
BLACK
</td>
<td align="right">
74
</td>
</tr>
<tr>
<td align="right">
7
</td>
<td align="right">
8
</td>
<td>
F
</td>
<td>
YES
</td>
<td>
HISPANIC
</td>
<td align="right">
72
</td>
</tr>
<tr>
<td align="right">
8
</td>
<td align="right">
4
</td>
<td>
M
</td>
<td>
YES
</td>
<td>
BLACK
</td>
<td align="right">
79
</td>
</tr>
<tr>
<td align="right">
9
</td>
<td align="right">
6
</td>
<td>
M
</td>
<td>
NO
</td>
<td>
WHITE
</td>
<td align="right">
88
</td>
</tr>
<tr>
<td align="right">
10
</td>
<td align="right">
7
</td>
<td>
M
</td>
<td>
YES
</td>
<td>
HISPANIC
</td>
<td align="right">
87
</td>
</tr>
<tr>
<td align="right">
11
</td>
<td align="right">
3
</td>
<td>
M
</td>
<td>
NO
</td>
<td>
WHITE
</td>
<td align="right">
79
</td>
</tr>
<tr>
<td align="right">
12
</td>
<td align="right">
6
</td>
<td>
F
</td>
<td>
NO
</td>
<td>
WHITE
</td>
<td align="right">
84
</td>
</tr>
<tr>
<td align="right">
13
</td>
<td align="right">
8
</td>
<td>
M
</td>
<td>
NO
</td>
<td>
WHITE
</td>
<td align="right">
90
</td>
</tr>
<tr>
<td align="right">
14
</td>
<td align="right">
5
</td>
<td>
M
</td>
<td>
NO
</td>
<td>
WHITE
</td>
<td align="right">
73
</td>
</tr>
<tr>
<td align="right">
15
</td>
<td align="right">
8
</td>
<td>
F
</td>
<td>
NO
</td>
<td>
WHITE
</td>
<td align="right">
72
</td>
</tr>
</table>
<p>The first table represents the first ten lines of the data “tli”.(This data set contains math scores and demographic data of 100 randomly selected students participating in the Texas Assessment of Academic Skills (TAAS).) It has 5 columns, including sex, disadvg, ethnicty and tlimth.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">## Demonstrate aov</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>fm1 &lt;-<span class="st"> </span><span class="kw">aov</span>(tlimth <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>ethnicty <span class="op">+</span><span class="st"> </span>grade <span class="op">+</span><span class="st"> </span>disadvg, <span class="dt">data =</span> tli)</span>
<span id="cb5-3"><a href="#cb5-3"></a>fm1t &lt;-<span class="st"> </span><span class="kw">xtable</span>(fm1)</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="kw">print</span>(fm1t, <span class="dt">type =</span> <span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<!-- html table generated in R 4.0.2 by xtable 1.8-4 package -->
<!-- Sat Dec 19 14:29:43 2020 -->
<table border="1">
<tr>
<th>
</th>
<th>
Df
</th>
<th>
Sum Sq
</th>
<th>
Mean Sq
</th>
<th>
F value
</th>
<th>
Pr(&gt;F)
</th>
</tr>
<tr>
<td>
sex
</td>
<td align="right">
1
</td>
<td align="right">
75.37
</td>
<td align="right">
75.37
</td>
<td align="right">
0.38
</td>
<td align="right">
0.5417
</td>
</tr>
<tr>
<td>
ethnicty
</td>
<td align="right">
3
</td>
<td align="right">
2572.15
</td>
<td align="right">
857.38
</td>
<td align="right">
4.27
</td>
<td align="right">
0.0072
</td>
</tr>
<tr>
<td>
grade
</td>
<td align="right">
1
</td>
<td align="right">
36.31
</td>
<td align="right">
36.31
</td>
<td align="right">
0.18
</td>
<td align="right">
0.6717
</td>
</tr>
<tr>
<td>
disadvg
</td>
<td align="right">
1
</td>
<td align="right">
59.30
</td>
<td align="right">
59.30
</td>
<td align="right">
0.30
</td>
<td align="right">
0.5882
</td>
</tr>
<tr>
<td>
Residuals
</td>
<td align="right">
93
</td>
<td align="right">
18682.87
</td>
<td align="right">
200.89
</td>
<td align="right">
</td>
<td align="right">
</td>
</tr>
</table>
<p>The second table outputs the result of the analysis of variance.</p>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>The 3rd example should contain at least a couple of LaTeX formulas.</p>
</div>
<div id="answer3" class="section level2">
<h2>Answer3</h2>
<p>Here gives two theorems of the sets in math. <span class="math display">\[\begin{equation}
if \ A{\subset}B,B{\subset}C \Longrightarrow A{\subset}C 
\end{equation}\]</span> <span class="math display">\[\begin{equation}
if \ \forall i\neq j,A_i\cap A_j=\varnothing.Then \ P(\bigcup\limits_{i=1}^\infty A_i)=\sum\limits_{i=1}^\infty P(A_i)
\end{equation}\]</span></p>
</div>
<div id="homework-1" class="section level2">
<h2>Homework 1</h2>
</div>
<div id="question-3.3" class="section level2">
<h2>Question 3.3</h2>
<p>The Pareto(a,b) distribution has cdf <span class="math inline">\(F(x)=1−(\frac{b}{x}) ^ a ,x ≥ b &gt; 0, a &gt; 0\)</span>. Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2, 2) distribution. Graph the density histogram of the sample with the Pareto(2, 2) density superimposed for comparison.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>The probability inverse transformation is: <span class="math display">\[F^{-1}(u)=\frac{b}{(1-u)^{\frac{1}{a}}}.\]</span> Then use the inverse transform method to simulate a random sample from the Pareto(2, 2) distribution.The Pareto(2, 2) has cdf <span class="math display">\[F(x)=1−(\frac{2}{x})^2 ,x ≥ 2,\]</span> the corresponding probability inverse transformation <span class="math display">\[F^{-1}(u)=\frac{2}{(1-u)^{\frac{1}{2}}}, \]</span>and the pdf<span class="math display">\[f(x)=\frac{8}{x^3},x ≥ 2.\]</span></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n) </span>
<span id="cb6-4"><a href="#cb6-4"></a>x &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">/</span>(u<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)) </span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="kw">hist</span>(x,<span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">8</span><span class="op">/</span>x<span class="op">^</span><span class="dv">3</span>),<span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="co">#density histogram of sample </span></span>
<span id="cb6-6"><a href="#cb6-6"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(x), <span class="kw">max</span>(x), <span class="fl">.01</span>) </span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="kw">lines</span>(y, <span class="dv">8</span><span class="op">/</span>y<span class="op">^</span><span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>) <span class="co">#density curve f(x)</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3.9" class="section level2">
<h2>Question 3.9</h2>
<p>The rescaled Epanechnikov kernel [85] is a symmetric density function <span class="math inline">\(f_e(x)=\frac{3}{4}(1−x^2), |x| ≤ 1\)</span>. (3.10) Devroye and Gyorﬁ [71, p. 236] give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_1,U_2,U_3 ∼ Uniform(−1,1)\)</span>. If <span class="math inline">\(|U_3|≥ |U_2|\)</span> and <span class="math inline">\(|U_3|≥| U_1|\)</span>, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver$ U_3$. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>The function fe(.) can generate random variates from <span class="math inline">\(f_e\)</span>.We use fe(.) to generate 10000 random variates.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>rEpanechnikov&lt;-<span class="cf">function</span>(n){</span>
<span id="cb7-3"><a href="#cb7-3"></a>  x0&lt;-<span class="kw">c</span>()</span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb7-5"><a href="#cb7-5"></a>    U&lt;-<span class="kw">runif</span>(<span class="dv">3</span>,<span class="dt">min =</span> <span class="dv">-1</span>,<span class="dt">max =</span> <span class="dv">1</span>)</span>
<span id="cb7-6"><a href="#cb7-6"></a>    <span class="cf">if</span>((<span class="kw">abs</span>(U[<span class="dv">1</span>])<span class="op">&lt;=</span><span class="kw">abs</span>(U[<span class="dv">3</span>]))<span class="op">&amp;</span>(<span class="kw">abs</span>(U[<span class="dv">2</span>])<span class="op">&lt;=</span><span class="kw">abs</span>(U[<span class="dv">3</span>])))</span>
<span id="cb7-7"><a href="#cb7-7"></a>      x0&lt;-<span class="kw">c</span>(x0,U[<span class="dv">2</span>])</span>
<span id="cb7-8"><a href="#cb7-8"></a>    <span class="cf">else</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>      x0&lt;-<span class="kw">c</span>(x0,U[<span class="dv">3</span>])</span>
<span id="cb7-10"><a href="#cb7-10"></a>  }</span>
<span id="cb7-11"><a href="#cb7-11"></a>  x0</span>
<span id="cb7-12"><a href="#cb7-12"></a>}</span>
<span id="cb7-13"><a href="#cb7-13"></a>x&lt;-<span class="kw">rEpanechnikov</span>(<span class="dv">1000</span>)</span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)),<span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="co">#density histogram of x</span></span>
<span id="cb7-15"><a href="#cb7-15"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(x), <span class="kw">max</span>(x), <span class="fl">.01</span>) </span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="kw">lines</span>(y, <span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">^</span><span class="dv">2</span>), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>) <span class="co">#density curve f(x)</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3.10" class="section level2">
<h2>Question 3.10</h2>
<p>Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e (3.10)\)</span>.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p><span class="math display">\[define \ \ A=\{|U_3|\ge|U_2| \&amp; |U_3|\ge|U_1|\}\]</span> <span class="math display">\[P(Y\le y)=P(Y\le y,A)+P(Y\le y,A^c)\]</span> <span class="math inline">\(P(Y\ge y,A)\\=P(U_2\ge y,A)\\=\int_{-1}^{y}du_2\int_{|u_3|\ge|u_2|}du_3\int_{|u_3|\ge|u_1|}f(u_1,u_2,u_3)du_1\\=\int_{-1}^{y}du_2\int_{|u_3|\ge|u_2|}du_3\int_{|u_3|\ge|u_1|}\frac{1}{8}du_1\\=\frac{y-\frac{1}{3}y^3}{4}\)</span></p>
<p><span class="math inline">\(P(Y\le y,A^c)\\=P(U_3\le y,A^c)\\=P(U_3\le y)-P(U_3\le y,A)\\=\frac{y+1}{2}-\int_{-1}^{y}du_3\int_{|u_3|\ge|u_2|}du_2\int_{|u_3|\ge|u_1|}\frac{1}{8}du_1\\=\frac{y}{2}-\frac{y^3-2}{6}\)</span></p>
<p><span class="math inline">\(f(y)\\=(\frac{y-\frac{1}{3}y^3}{4}+\frac{y}{2}-\frac{y^3-2}{6})^{&#39;}\\=\frac{3}{4}(1-y^2)\)</span></p>
</div>
<div id="question-3.13" class="section level2">
<h2>Question 3.13</h2>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math inline">\(F(y)=1−(\frac{β}{β + y})^r,y ≥ 0\)</span>. (This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with <span class="math inline">\(r = 4\)</span> and <span class="math inline">\(β = 2\)</span>. Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p>With <span class="math inline">\(r = 4\)</span> and <span class="math inline">\(β = 2\)</span>, the cdf is <span class="math display">\[F(y)=1−(\frac{2}{2 + y})^4,y ≥ 0,\]</span>the probability inverse transformation is <span class="math display">\[F^{-1}(u)=\frac{2}{(1-u)^{\frac{1}{4}}}-2,\]</span> the pdf is <span class="math display">\[f(x)=\frac{64}{(2+y)^5}.\]</span></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>rPareto&lt;-<span class="cf">function</span>(n,beta,r){</span>
<span id="cb8-4"><a href="#cb8-4"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(n) </span>
<span id="cb8-5"><a href="#cb8-5"></a>  x &lt;-<span class="st"> </span>beta<span class="op">/</span>(u<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>r))<span class="op">-</span>beta</span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="kw">return</span>(x)</span>
<span id="cb8-7"><a href="#cb8-7"></a>}</span>
<span id="cb8-8"><a href="#cb8-8"></a>x&lt;-<span class="kw">rPareto</span>(n,<span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="kw">hist</span>(x, <span class="dt">breaks=</span><span class="dv">40</span>,<span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">64</span><span class="op">/</span>(<span class="dv">2</span><span class="op">+</span>x)<span class="op">^</span><span class="dv">5</span>),<span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="co">#density histogram of sample </span></span>
<span id="cb8-10"><a href="#cb8-10"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(x), <span class="kw">max</span>(x), <span class="fl">.01</span>) </span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="kw">lines</span>(y, <span class="dv">64</span><span class="op">*</span>(<span class="dv">2</span><span class="op">+</span>y)<span class="op">^</span>(<span class="op">-</span><span class="dv">5</span>), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>) <span class="co">#density curve f(x)</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="homework-2" class="section level2">
<h2>Homework 2</h2>
</div>
<div id="question-5.1" class="section level2">
<h2>Question 5.1</h2>
<p>Compute a Monte Carlo estimate of<span class="math display">\[\int^{\pi/3}_0 \sin t\ dt\]</span> and compare your estimate with the exact value of the integral.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>n&lt;-<span class="dv">10000</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a>t&lt;-<span class="kw">runif</span>(n,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb9-4"><a href="#cb9-4"></a>a_hat&lt;-<span class="kw">mean</span>(<span class="kw">sin</span>(t))</span>
<span id="cb9-5"><a href="#cb9-5"></a>a&lt;-<span class="kw">cos</span>(<span class="dv">0</span>)<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="kw">cbind</span>(a_hat,a)</span></code></pre></div>
<pre><code>##          a_hat   a
## [1,] 0.4756314 0.5</code></pre>
<p>The estimated value is nearly equal to the exact value of the integral.</p>
</div>
<div id="question-5.7" class="section level2">
<h2>Question 5.7</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>As for simple MC <span class="math inline">\(\theta=Ee^X,X\thicksim U[0,1],\hat{\theta}=\frac{1}{m}\sum_{i=1}^m e^{X_i},X_i\thicksim U[0,1]\)</span>,so the theoretical value of variance is <span class="math display">\[\begin{aligned}
Var(\hat{\theta})&amp;=\frac{1}{m}Var(e^X)\\
&amp;=\frac{1}{m}(E(e^{2X})-(Ee^X)^2)\\
&amp;=\frac{1}{m}(2e-e^2/2-3/2)
\end{aligned}\]</span></p>
<p>As for antithetic variate approach <span class="math inline">\(\theta=E(\frac{e^X+e^{1-X}}{2}),X\thicksim U[0,1],\hat{\theta}=\frac{1}{m}\sum_{i=1}^{m/2} {(e^{X_i}+e^{1-X_i})},X_i\thicksim U[0,1]\)</span>,so the theoretical value of variance is <span class="math display">\[\begin{aligned}
Var(\hat{\theta})&amp;=\frac{1}{2m}Var(e^X+e^{1-X})\\
&amp;=\frac{1}{2m}(2Var(e^X)+2Cov(e^X,e^{1-X}))\\
&amp;=\frac{1}{m}[2e-e^2/2-3/2+e-(e-1)^2]\\
&amp;=\frac{1}{m}(5e-3e^2/2-5/2)
\end{aligned}\]</span></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a>MC.theta&lt;-<span class="cf">function</span>(n,anti){</span>
<span id="cb11-3"><a href="#cb11-3"></a>  x1&lt;-<span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span><span class="dv">1</span>)</span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="cf">if</span>(<span class="op">!</span>anti) {</span>
<span id="cb11-5"><a href="#cb11-5"></a>    x2&lt;-<span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span><span class="dv">1</span>)<span class="co">#simple Monte Carlo method</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>    x&lt;-<span class="kw">exp</span>(<span class="kw">c</span>(x1,x2))</span>
<span id="cb11-7"><a href="#cb11-7"></a>  }</span>
<span id="cb11-8"><a href="#cb11-8"></a>  <span class="cf">else</span> {</span>
<span id="cb11-9"><a href="#cb11-9"></a>    x2&lt;-<span class="dv">1</span><span class="op">-</span>x1<span class="co">#antithetic variate approach</span></span>
<span id="cb11-10"><a href="#cb11-10"></a>    x&lt;-(<span class="kw">exp</span>(x1)<span class="op">+</span><span class="kw">exp</span>(x2))<span class="op">/</span><span class="dv">2</span></span>
<span id="cb11-11"><a href="#cb11-11"></a>  }</span>
<span id="cb11-12"><a href="#cb11-12"></a>  x</span>
<span id="cb11-13"><a href="#cb11-13"></a>}</span>
<span id="cb11-14"><a href="#cb11-14"></a>m&lt;-<span class="dv">5000</span></span>
<span id="cb11-15"><a href="#cb11-15"></a>mc1&lt;-<span class="kw">MC.theta</span>(m,<span class="dt">anti =</span> <span class="ot">FALSE</span>)</span>
<span id="cb11-16"><a href="#cb11-16"></a>theta_hat&lt;-<span class="kw">mean</span>(mc1)<span class="co">#Simple MC</span></span>
<span id="cb11-17"><a href="#cb11-17"></a>mc2&lt;-<span class="kw">MC.theta</span>(m,<span class="dt">anti =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-18"><a href="#cb11-18"></a>theta1_hat&lt;-<span class="kw">mean</span>(mc2)<span class="co">#Antithetic approach</span></span></code></pre></div>
<p>The estimated value and true value of theta</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">rbind</span>(<span class="st">&quot;Simple MC&quot;</span>=theta_hat,<span class="st">&quot;Antithetic approach&quot;</span>=theta1_hat,<span class="st">&quot;True value&quot;</span>=<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="dv">0</span>))</span></code></pre></div>
<pre><code>##                         [,1]
## Simple MC           1.713666
## Antithetic approach 1.716407
## True value          1.718282</code></pre>
<p>The estimated value and true value of the variance</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">rbind</span>(<span class="st">&quot;var of simple MC&quot;</span>=<span class="kw">var</span>(mc1)<span class="op">/</span>m,<span class="st">&quot;var of antithetic approach&quot;</span>=<span class="kw">var</span>(mc2)<span class="op">/</span>(m<span class="op">/</span><span class="dv">2</span>),<span class="st">&quot;the percent reduction in var&quot;</span>=(<span class="kw">var</span>(mc1)<span class="op">/</span>m<span class="op">-</span><span class="kw">var</span>(mc2)<span class="op">/</span>(m<span class="op">/</span><span class="dv">2</span>))<span class="op">/</span>(<span class="kw">var</span>(mc1)<span class="op">/</span>m))</span></code></pre></div>
<pre><code>##                                      [,1]
## var of simple MC             4.796576e-05
## var of antithetic approach   1.557247e-06
## the percent reduction in var 9.675342e-01</code></pre>
<p>The theoretical value of the variance</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">rbind</span>(<span class="st">&quot;theoretical variance of simple MC&quot;</span>=(<span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2-3</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>m,<span class="st">&quot;theoretical variance of antithetic approach&quot;</span>=(<span class="dv">5</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2-5</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>m)</span></code></pre></div>
<pre><code>##                                                     [,1]
## theoretical variance of simple MC           4.840712e-05
## theoretical variance of antithetic approach 1.564999e-06</code></pre>
</div>
<div id="question-5.11" class="section level2">
<h2>Question 5.11</h2>
<p>If <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are unbiased estimators of<span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are antithetic, wederived that <span class="math inline">\(c^*= 1/2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat{\theta}_c=c\hat{\theta}_1+(1-c)\hat{\theta}_2\)</span>. Derive <span class="math inline">\(c^*\)</span> for the general case. That is, if <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span>are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^*\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat{\theta}_c=c\hat{\theta}_1+(1-c)\hat{\theta}_2\)</span> in equation (5.11). (<span class="math inline">\(c^*\)</span> will be a function of the variances and the covariance of the estimators.)</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p><span class="math display">\[\begin{aligned}
Var(\hat{\theta_c})&amp;=c^2Var(\hat{\theta_1})+(1-c)^2Var(\hat{\theta_2})+2c(1-c)Cov(\hat{\theta_1},\hat{\theta_1})\\
&amp;=c^2Var(\hat{\theta_1})+(1+c^2-2c)Var(\hat{\theta_2})+2c^2Cov(\hat{\theta_1},\hat{\theta_1})\\
&amp;=(Var(\hat{\theta_1})+Var(\hat{\theta_2})-2Cov(\hat{\theta_1},\hat{\theta_1}))c^2+(2Cov(\hat{\theta_1},\hat{\theta_1})-2Var(\hat{\theta_2}))c+Var(\hat{\theta_2})
\end{aligned}\]</span></p>
<p>Thus when <span class="math display">\[\begin{aligned}
c^*&amp;=\frac{2Cov(\hat{\theta_1},\hat{\theta_2})-2Var(\hat{\theta_2})}{-2(Var(\hat{\theta_1})+Var(\hat{\theta_2})-2Cov(\hat{\theta_1},\hat{\theta_1}))}\\
&amp;=\frac{Var(\hat{\theta_2})-Cov(\hat{\theta_1},\hat{\theta_2})}{Var(\hat{\theta_1})+Var(\hat{\theta_2})-2Cov(\hat{\theta_1},\hat{\theta_2})}
\end{aligned}\]</span>can we get the minimum。 What’s more，<span class="math inline">\(\hat{\theta}_1\)</span>and<span class="math inline">\(\hat{\theta}_2\)</span>are antithetic。so <span class="math inline">\(Cov(\hat{\theta_1},\hat{\theta_1})=-Var(\hat{\theta_1})，Var(\hat{\theta_1})=Var(\hat{\theta_2})\)</span>。Thus <span class="math inline">\(c^*=\frac{2Var(\hat{\theta_1})}{4Var(\hat{\theta_1})}=1/2\)</span>.</p>
</div>
<div id="homework-3" class="section level2">
<h2>Homework 3</h2>
</div>
<div id="question-5.13" class="section level2">
<h2>Question 5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to<span class="math display">\[g(x) = \frac{x^2}{√2π} e^{−x^2/2}, x&gt; 1.\]</span> Which of your two importance functions should produce the smaller variance in estimating<span class="math display">\[\int_1^{\infty}\frac{x^2}{√2π} e^{−x^2/2}\ dx\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p><strong>Choose <span class="math inline">\(f_1(x)&lt;-x*exp((1-x^2)/2)\)</span> </strong></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a>m&lt;-<span class="dv">5000</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>g&lt;-<span class="cf">function</span>(x) x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co">#inverse transform method#inverse transform method</span></span>
<span id="cb18-5"><a href="#cb18-5"></a>y&lt;-<span class="kw">rexp</span>(m,<span class="dt">rate =</span> <span class="dv">1</span>)</span>
<span id="cb18-6"><a href="#cb18-6"></a>x1&lt;-<span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>y<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb18-7"><a href="#cb18-7"></a>f1g&lt;-<span class="kw">g</span>(x1)<span class="op">/</span>(x1<span class="op">*</span><span class="kw">exp</span>((<span class="dv">1</span><span class="op">-</span>x1<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb18-8"><a href="#cb18-8"></a>theta_hat1&lt;-<span class="kw">mean</span>(f1g)</span></code></pre></div>
<p><strong>Choose <span class="math inline">\(f_2(x)\)</span> as conditional norm distribution</strong></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co">#inverse transform method</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb19-3"><a href="#cb19-3"></a>x2&lt;-<span class="kw">rnorm</span>(<span class="dv">10</span><span class="op">*</span>m)</span>
<span id="cb19-4"><a href="#cb19-4"></a>x2&lt;-x2[x2<span class="op">&gt;</span><span class="dv">1</span>]</span>
<span id="cb19-5"><a href="#cb19-5"></a>f2g&lt;-<span class="kw">g</span>(x2)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>x2<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(<span class="dv">1</span>)))</span>
<span id="cb19-6"><a href="#cb19-6"></a>theta_hat2&lt;-<span class="kw">mean</span>(f2g)</span>
<span id="cb19-7"><a href="#cb19-7"></a>true.value=<span class="kw">integrate</span>(g,<span class="dv">1</span>,<span class="ot">Inf</span>)</span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="kw">cat</span>(<span class="st">&quot;The estimated value is:</span><span class="ch">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## The estimated value is:</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">cbind</span>(theta_hat1,theta_hat2,<span class="dt">TRUE.VALUE=</span>true.value<span class="op">$</span>value)</span></code></pre></div>
<pre><code>##      theta_hat1 theta_hat2 TRUE.VALUE
## [1,]  0.4016957  0.3995025   0.400626</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">cat</span>(<span class="st">&quot;The variance using f1 and f2: </span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="kw">c</span>(<span class="kw">var</span>(f1g),<span class="kw">var</span>(f2g)))</span></code></pre></div>
<pre><code>## The variance using f1 and f2: 
##  0.01530846 0.06821547</code></pre>
<p><strong>The variance of <span class="math inline">\(f_1\)</span> is smaller.</strong></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="fl">.1</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a>w &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>f1 &lt;-<span class="st"> </span>x<span class="op">*</span><span class="kw">exp</span>((<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb25-4"><a href="#cb25-4"></a>f2 &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(<span class="dv">1</span>))</span>
<span id="cb25-5"><a href="#cb25-5"></a>g0 &lt;-<span class="st"> </span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="co">#figure (b)</span></span>
<span id="cb25-7"><a href="#cb25-7"></a><span class="kw">plot</span>(x, g0, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>), <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">lwd =</span> w, <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb25-8"><a href="#cb25-8"></a><span class="kw">lines</span>(x, g0<span class="op">/</span>f1, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>, <span class="dt">lwd =</span> w)</span>
<span id="cb25-9"><a href="#cb25-9"></a><span class="kw">lines</span>(x, g0<span class="op">/</span>f2, <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>, <span class="dt">lwd =</span> w)</span>
<span id="cb25-10"><a href="#cb25-10"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;g/f1&#39;</span>,<span class="st">&#39;g/f2&#39;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;red&#39;</span>,<span class="st">&#39;blue&#39;</span>), <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>From the figures, we can see that the <span class="math inline">\(\frac{g}{f_1}\)</span>is more tend to a nearly constant, so the variance is smaller.</strong></p>
</div>
<div id="question-5.15" class="section level2">
<h2>Question 5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p><strong>Method 1</strong></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>M &lt;-<span class="st"> </span><span class="dv">5000</span> <span class="co">#number of replicates</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>k &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co">#number of strata</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>r &lt;-<span class="st"> </span>M <span class="op">/</span><span class="st"> </span>k <span class="co">#replicates per stratum</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>N &lt;-<span class="st"> </span><span class="dv">50</span> <span class="co">#number of times to repeat the estimation</span></span>
<span id="cb26-6"><a href="#cb26-6"></a>T2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</span>
<span id="cb26-7"><a href="#cb26-7"></a>estimates &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb26-8"><a href="#cb26-8"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb26-9"><a href="#cb26-9"></a>  <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb26-10"><a href="#cb26-10"></a>}</span>
<span id="cb26-11"><a href="#cb26-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb26-12"><a href="#cb26-12"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb26-13"><a href="#cb26-13"></a>  u&lt;-<span class="kw">runif</span>(M<span class="op">/</span>k)</span>
<span id="cb26-14"><a href="#cb26-14"></a>  x&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span>k)<span class="op">-</span>u<span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span>k)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span>k)))</span>
<span id="cb26-15"><a href="#cb26-15"></a>  fg&lt;-<span class="kw">g</span>(x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>(j<span class="dv">-1</span>)<span class="op">/</span>k)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span>k)))</span>
<span id="cb26-16"><a href="#cb26-16"></a>  T2[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb26-17"><a href="#cb26-17"></a>}</span>
<span id="cb26-18"><a href="#cb26-18"></a>estimates[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(T2)</span>
<span id="cb26-19"><a href="#cb26-19"></a>}</span></code></pre></div>
<p><strong>Method 2</strong></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)</span>
<span id="cb27-3"><a href="#cb27-3"></a>}</span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb27-6"><a href="#cb27-6"></a>  u&lt;-<span class="kw">runif</span>(M<span class="op">/</span>k,(j<span class="dv">-1</span>)<span class="op">/</span>k,j<span class="op">/</span>k)</span>
<span id="cb27-7"><a href="#cb27-7"></a>  x&lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb27-8"><a href="#cb27-8"></a>  fg&lt;-<span class="kw">g</span>(x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span>k)</span>
<span id="cb27-9"><a href="#cb27-9"></a>  T2[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb27-10"><a href="#cb27-10"></a>}</span>
<span id="cb27-11"><a href="#cb27-11"></a>estimates[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(T2)</span>
<span id="cb27-12"><a href="#cb27-12"></a>}</span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="kw">cat</span>(<span class="st">&quot;The estimated value are:</span><span class="ch">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## The estimated value are:</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">apply</span>(estimates,<span class="dv">2</span>,mean)</span></code></pre></div>
<pre><code>## [1] 0.5247815 0.5248401</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">cat</span>(<span class="st">&quot;The ses are:</span><span class="ch">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## The ses are:</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">apply</span>(estimates,<span class="dv">2</span>,sd)</span></code></pre></div>
<pre><code>## [1] 0.0002732155 0.0002772057</code></pre>
<p><strong>The result in example5.10 shows that the mean is 0.52506988 and the se is 0.09658794. Our estimated mean is nearly equal to it, but our se is much smaller than 0.09658794.</strong></p>
</div>
<div id="question-6.4" class="section level2">
<h2>Question 6.4</h2>
<p>Suppose that <span class="math inline">\(X_1,...,X_n\)</span> are a random sample from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p>For lognormal distribution<span class="math inline">\(X\)</span>,<span class="math inline">\(Y=\ln(X) \sim N(\mu,\sigma^2)\)</span>,the mean of X and Y is <span class="math inline">\(\theta,\mu\)</span>,<span class="math inline">\(\theta=\exp \left(\mu+\sigma^{2} / 2\right)\)</span>,define: <span class="math display">\[
W^{2}=\frac{1}{n-1} \sum_{i=1}^{n}\left(\ln X_{i}-\frac{1}{n} \sum_{i=1}^{n} \ln X_{i}\right)^{2}
\]</span> and we can get <span class="math inline">\(E W^2=\sigma^2\)</span>. <span class="math display">\[
\frac{\frac{1}{n} \sum_{i=1}^{n} \ln X_{i}-\mu}{W / \sqrt{n}} \sim t(n-1)
\]</span></p>
<p><span class="math display">\[
-t_\frac{a}{2}(n-1)&lt;\frac{\frac{1}{n} \sum_{i=1}^{n} \ln X_{i}-\mu}{W / \sqrt{n}}&lt;t_\frac{a}{2}(n-1)
\]</span> Thus, the confidence interval is: <span class="math display">\[
\left[\frac{1}{n} \sum_{i=1}^{n} \ln X_{i}-t_\frac{a}{2}(n-1) \cdot \frac{W}{\sqrt{n}},\frac{1}{n} \sum_{i=1}^{n} \ln X_{i}+t_\frac{a}{2}(n-1) \cdot \frac{W}{\sqrt{n}}\right]
\]</span></p>
<p><strong>Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span></strong></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb35-2"><a href="#cb35-2"></a>n&lt;-<span class="dv">2000</span></span>
<span id="cb35-3"><a href="#cb35-3"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb35-4"><a href="#cb35-4"></a>Up &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</span>
<span id="cb35-5"><a href="#cb35-5"></a>x &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb35-6"><a href="#cb35-6"></a>w&lt;-<span class="kw">sd</span>(<span class="kw">log</span>(x))</span>
<span id="cb35-7"><a href="#cb35-7"></a><span class="kw">mean</span>(<span class="kw">log</span>(x))<span class="op">+</span>w<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb35-8"><a href="#cb35-8"></a>} )</span>
<span id="cb35-9"><a href="#cb35-9"></a>Low &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</span>
<span id="cb35-10"><a href="#cb35-10"></a>x &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb35-11"><a href="#cb35-11"></a>w&lt;-<span class="kw">sd</span>(<span class="kw">log</span>(x))</span>
<span id="cb35-12"><a href="#cb35-12"></a><span class="kw">mean</span>(<span class="kw">log</span>(x))<span class="op">-</span>w<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb35-13"><a href="#cb35-13"></a>} )</span>
<span id="cb35-14"><a href="#cb35-14"></a><span class="kw">cat</span>(<span class="st">&quot;one emprical estimate of 95% CI for mean is :&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&#39;[&#39;</span>,<span class="kw">mean</span>(Low),<span class="kw">mean</span>(Up),<span class="st">&#39;]&#39;</span>)</span></code></pre></div>
<pre><code>## one emprical estimate of 95% CI for mean is : 
##  [ 0.9124522 1.085605 ]</code></pre>
<p><strong>empirical estimate of the confidence level:</strong></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw">cat</span>(<span class="st">&quot;an empirical estimate of the confidence level:</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="kw">mean</span>((Up<span class="op">&gt;</span><span class="dv">1</span>)<span class="op">&amp;</span>(Low<span class="op">&lt;</span><span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## an empirical estimate of the confidence level:
##  0.949</code></pre>
</div>
<div id="question-6.5" class="section level2">
<h2>Question 6.5</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(χ^2(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<p><strong>Use the 95% symmetric t-interval to estimate the mean.</strong></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb39-2"><a href="#cb39-2"></a>n&lt;-<span class="dv">20</span></span>
<span id="cb39-3"><a href="#cb39-3"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb39-4"><a href="#cb39-4"></a>Up &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</span>
<span id="cb39-5"><a href="#cb39-5"></a>x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">2</span>)</span>
<span id="cb39-6"><a href="#cb39-6"></a><span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb39-7"><a href="#cb39-7"></a>} )</span>
<span id="cb39-8"><a href="#cb39-8"></a>Low &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</span>
<span id="cb39-9"><a href="#cb39-9"></a>x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">2</span>)</span>
<span id="cb39-10"><a href="#cb39-10"></a><span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb39-11"><a href="#cb39-11"></a>} )</span></code></pre></div>
<p><strong>The probability that the confidence interval covers the mean is:</strong></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">cat</span>(<span class="st">&#39;The probability that the confidence interval covers the mean is:</span><span class="ch">\n</span><span class="st">&#39;</span>,<span class="kw">mean</span>((Low<span class="op">&lt;</span><span class="dv">2</span>)<span class="op">&amp;</span>(Up<span class="op">&gt;</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## The probability that the confidence interval covers the mean is:
##  0.907</code></pre>
<p><strong>The simulation results in Example 6.4</strong></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>Up &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</span>
<span id="cb42-2"><a href="#cb42-2"></a>x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">2</span>)</span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="kw">var</span>(x)<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">qchisq</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb42-4"><a href="#cb42-4"></a>} )</span>
<span id="cb42-5"><a href="#cb42-5"></a><span class="kw">cat</span>(<span class="st">&quot;The simulation results in Example 6.4</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="kw">mean</span>(Up<span class="op">&gt;</span><span class="dv">4</span>))</span></code></pre></div>
<pre><code>## The simulation results in Example 6.4
##  0.779</code></pre>
<p><strong>From the result,the t-interval is more robust.</strong></p>
</div>
<div id="homework-4" class="section level2">
<h2>Homework 4</h2>
</div>
<div id="question-6.7" class="section level2">
<h2>Question 6.7</h2>
<p><strong>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>?</strong></p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<p><strong>A test for normality based on skewness rejects the hypothesis of normality for large values of <span class="math inline">\(|\sqrt{b_1}|\)</span>. The hypotheses are<span class="math inline">\(H_0:\sqrt{\beta_1}=0;\ H_0:\sqrt{\beta_1}\neq 0\)</span></strong></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>sks &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb44-2"><a href="#cb44-2"></a>  m &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb44-3"><a href="#cb44-3"></a>  a &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>m)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb44-4"><a href="#cb44-4"></a>  b &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>m)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb44-5"><a href="#cb44-5"></a>  <span class="kw">return</span>(a<span class="op">/</span>b<span class="op">^</span><span class="fl">1.5</span>)</span>
<span id="cb44-6"><a href="#cb44-6"></a>}</span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="co">#For this experiment, the significance level is 0.1 and the sample size is n = 30.</span></span>
<span id="cb44-8"><a href="#cb44-8"></a>sl &lt;-<span class="st"> </span><span class="fl">.1</span></span>
<span id="cb44-9"><a href="#cb44-9"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb44-10"><a href="#cb44-10"></a>m &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb44-11"><a href="#cb44-11"></a>alpha &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="fl">0.5</span>, <span class="dv">50</span>, <span class="fl">0.5</span>))</span>
<span id="cb44-12"><a href="#cb44-12"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(alpha)<span class="co">#不同的参数值个数</span></span>
<span id="cb44-13"><a href="#cb44-13"></a>pw1 &lt;-<span class="st"> </span>pw2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb44-14"><a href="#cb44-14"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb44-15"><a href="#cb44-15"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>sl<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb44-16"><a href="#cb44-16"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb44-17"><a href="#cb44-17"></a>e &lt;-<span class="st"> </span>alpha[j]</span>
<span id="cb44-18"><a href="#cb44-18"></a>sksts1 &lt;-<span class="st"> </span>sksts2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb44-19"><a href="#cb44-19"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb44-20"><a href="#cb44-20"></a>x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, e, e)<span class="co">#Beta distribution</span></span>
<span id="cb44-21"><a href="#cb44-21"></a>sksts1[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sks</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb44-22"><a href="#cb44-22"></a>y &lt;-<span class="st"> </span><span class="kw">rt</span>(n, e)<span class="co">#t distribution</span></span>
<span id="cb44-23"><a href="#cb44-23"></a>sksts2[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sks</span>(y)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb44-24"><a href="#cb44-24"></a>}</span>
<span id="cb44-25"><a href="#cb44-25"></a>pw1[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sksts1)</span>
<span id="cb44-26"><a href="#cb44-26"></a>pw2[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sksts2)</span>
<span id="cb44-27"><a href="#cb44-27"></a>}</span></code></pre></div>
<p><strong>For symmetric <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distributions:</strong></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">plot</span>(alpha, pw1, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="kw">bquote</span>(alpha), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb45-3"><a href="#cb45-3"></a>se1 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pw1 <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pw1) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></span>
<span id="cb45-4"><a href="#cb45-4"></a><span class="kw">lines</span>(alpha, pw1<span class="op">+</span>se1, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb45-5"><a href="#cb45-5"></a><span class="kw">lines</span>(alpha, pw1<span class="op">-</span>se1, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>For heavy-tailed symmetric alternatives <span class="math inline">\(t(\nu)\)</span>:</strong></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">plot</span>(alpha, pw2, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="kw">bquote</span>(alpha), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb46-3"><a href="#cb46-3"></a>se2 &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pw2 <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pw2) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="kw">lines</span>(alpha, pw2<span class="op">+</span>se2, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb46-5"><a href="#cb46-5"></a><span class="kw">lines</span>(alpha, pw2<span class="op">-</span>se2, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>From the figures above, the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distributions are all below 0.1.It can hardly reject the hypotheses under each <span class="math inline">\(Beta(\alpha,\alpha)\)</span>.</strong></p>
<p><strong>For heavy-tailed symmetric alternatives <span class="math inline">\(t(\nu)\)</span>, the power of the skewness test of normality are all above 0.1. The power declines rapidly when df becomes larger.I suppoese that, it is because t distribution is similar to norm distribution when df is large.</strong></p>
</div>
<div id="question-6.8" class="section level2">
<h2>Question 6.8</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level <span class="math inline">\(\hat{\alpha} = 0.055\)</span>. Compare the power of the Count Five test and F test for small, medium, and large sample sizes. (Recall that the F test is not applicable for non-normal distributions.)</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<p><strong>c5t is a function to compute the the Count Five test and Ft is a function to compute the F test.</strong></p>
<p><strong>Compare the power of the Count Five test and F test for small, medium, and large sample sizes.</strong></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>c5t &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb47-2"><a href="#cb47-2"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb47-3"><a href="#cb47-3"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb47-4"><a href="#cb47-4"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb47-5"><a href="#cb47-5"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb47-6"><a href="#cb47-6"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb47-7"><a href="#cb47-7"></a>}</span>
<span id="cb47-8"><a href="#cb47-8"></a>Ft &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, p) {</span>
<span id="cb47-9"><a href="#cb47-9"></a>  a&lt;-<span class="kw">var.test</span>(x, y, <span class="dt">conf.level =</span> <span class="dv">1</span><span class="op">-</span>p)</span>
<span id="cb47-10"><a href="#cb47-10"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(a<span class="op">$</span>p.value <span class="op">&lt;=</span><span class="st"> </span>p))</span>
<span id="cb47-11"><a href="#cb47-11"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="co"># generate samples under H1 to estimate power</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>s1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb48-3"><a href="#cb48-3"></a>s2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb48-4"><a href="#cb48-4"></a>N&lt;-<span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">100</span>,<span class="dv">1000</span>)</span>
<span id="cb48-5"><a href="#cb48-5"></a>m&lt;-<span class="dv">1000</span></span>
<span id="cb48-6"><a href="#cb48-6"></a>p5&lt;-pf&lt;-<span class="kw">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb48-7"><a href="#cb48-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) {</span>
<span id="cb48-8"><a href="#cb48-8"></a>  n=N[i]</span>
<span id="cb48-9"><a href="#cb48-9"></a>  <span class="co">#Count Five test</span></span>
<span id="cb48-10"><a href="#cb48-10"></a>  power5 &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb48-11"><a href="#cb48-11"></a>    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, s1)</span>
<span id="cb48-12"><a href="#cb48-12"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, s2)</span>
<span id="cb48-13"><a href="#cb48-13"></a>    <span class="kw">c5t</span>(x, y)</span>
<span id="cb48-14"><a href="#cb48-14"></a>    }))</span>
<span id="cb48-15"><a href="#cb48-15"></a>  p5[i]&lt;-power5</span>
<span id="cb48-16"><a href="#cb48-16"></a>  <span class="co">#F test</span></span>
<span id="cb48-17"><a href="#cb48-17"></a>  powerF &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb48-18"><a href="#cb48-18"></a>    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, s1)</span>
<span id="cb48-19"><a href="#cb48-19"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, s2)</span>
<span id="cb48-20"><a href="#cb48-20"></a>    <span class="kw">Ft</span>(x, y,<span class="fl">0.055</span>)</span>
<span id="cb48-21"><a href="#cb48-21"></a>    }))</span>
<span id="cb48-22"><a href="#cb48-22"></a>  pf[i]&lt;-powerF</span>
<span id="cb48-23"><a href="#cb48-23"></a>}</span>
<span id="cb48-24"><a href="#cb48-24"></a>P&lt;-<span class="kw">rbind</span>(p5,pf)</span></code></pre></div>
<p><strong>The power of the Count Five test and F test for small, medium, and large sample sizes</strong></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="kw">colnames</span>(P)&lt;-<span class="kw">c</span>(<span class="st">&#39;small size&#39;</span>,<span class="st">&#39;medium size&#39;</span>,<span class="st">&#39;large size&#39;</span>)</span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="kw">rownames</span>(P)&lt;-<span class="kw">c</span>(<span class="st">&#39;Count Five test&#39;</span>,<span class="st">&#39;F test&#39;</span>)</span>
<span id="cb49-3"><a href="#cb49-3"></a>knitr<span class="op">::</span><span class="kw">kable</span>(P,<span class="dt">align =</span> <span class="st">&quot;c&quot;</span>,<span class="dt">caption =</span> <span class="st">&quot;the power of the Count Five test vs F test&quot;</span>)</span></code></pre></div>
<table>
<caption>the power of the Count Five test vs F test</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">small size</th>
<th align="center">medium size</th>
<th align="center">large size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Count Five test</td>
<td align="center">0.201</td>
<td align="center">0.853</td>
<td align="center">0.998</td>
</tr>
<tr class="even">
<td align="left">F test</td>
<td align="center">0.312</td>
<td align="center">0.986</td>
<td align="center">1.000</td>
</tr>
</tbody>
</table>
</div>
<div id="question-6.c" class="section level2">
<h2>Question 6.C</h2>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If X and Y are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[
\beta_{1, d}=E\left[(X-\mu)^{T} \Sigma^{-1}(Y-\mu)\right]^{3}
\]</span> Under normality, <span class="math inline">\(\beta_{1,d}= 0.\)</span> The multivariate skewness statistic is <span class="math display">\[
b_{1, d}=\frac{1}{n^{2}} \sum_{i, j=1}^{n}\left(\left(X_{i}-\bar{X}\right)^{T} \widehat{\Sigma}^{-1}\left(X_{j}-\bar{X}\right)\right)^{3}
\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with d(d + 1)(d + 2)/6 degrees of freedom.</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<p>We first repeat Example 6.8 which evaluate t1e rate of Mardia’s multivariate skewness test. In our simulation we generate variables following <span class="math inline">\(N(\mu,\Sigma)\)</span>, where: <span class="math display">\[\mu=(0,0,0)^{T} , \Sigma=\left( \begin{array}{ccc}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \end{array} \right).\]</span></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw">library</span>(MASS)</span>
<span id="cb50-2"><a href="#cb50-2"></a>Mardia&lt;-<span class="cf">function</span>(mydata){</span>
<span id="cb50-3"><a href="#cb50-3"></a>  n=<span class="kw">nrow</span>(mydata)</span>
<span id="cb50-4"><a href="#cb50-4"></a>  c=<span class="kw">ncol</span>(mydata)</span>
<span id="cb50-5"><a href="#cb50-5"></a>  central&lt;-mydata</span>
<span id="cb50-6"><a href="#cb50-6"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>c){</span>
<span id="cb50-7"><a href="#cb50-7"></a>    central[,i]&lt;-mydata[,i]<span class="op">-</span><span class="kw">mean</span>(mydata[,i])</span>
<span id="cb50-8"><a href="#cb50-8"></a>  }</span>
<span id="cb50-9"><a href="#cb50-9"></a>  sigmah&lt;-<span class="kw">t</span>(central)<span class="op">%*%</span>central<span class="op">/</span>n</span>
<span id="cb50-10"><a href="#cb50-10"></a>  a&lt;-central<span class="op">%*%</span><span class="kw">solve</span>(sigmah)<span class="op">%*%</span><span class="kw">t</span>(central)</span>
<span id="cb50-11"><a href="#cb50-11"></a>  b&lt;-<span class="kw">sum</span>(<span class="kw">colSums</span>(a<span class="op">^</span>{<span class="dv">3</span>}))<span class="op">/</span>(n<span class="op">*</span>n)</span>
<span id="cb50-12"><a href="#cb50-12"></a>  test&lt;-n<span class="op">*</span>b<span class="op">/</span><span class="dv">6</span></span>
<span id="cb50-13"><a href="#cb50-13"></a>  chi&lt;-<span class="kw">qchisq</span>(<span class="fl">0.95</span>,c<span class="op">*</span>(c<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(c<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb50-14"><a href="#cb50-14"></a>  <span class="kw">as.integer</span>(test<span class="op">&gt;</span>chi)</span>
<span id="cb50-15"><a href="#cb50-15"></a>}</span>
<span id="cb50-16"><a href="#cb50-16"></a></span>
<span id="cb50-17"><a href="#cb50-17"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb50-18"><a href="#cb50-18"></a>mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb50-19"><a href="#cb50-19"></a>sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb50-20"><a href="#cb50-20"></a>m=<span class="dv">1000</span></span>
<span id="cb50-21"><a href="#cb50-21"></a>n&lt;-<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>)</span>
<span id="cb50-22"><a href="#cb50-22"></a><span class="co">#m: number of replicates; n: sample size</span></span>
<span id="cb50-23"><a href="#cb50-23"></a>a=<span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb50-24"><a href="#cb50-24"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb50-25"><a href="#cb50-25"></a>  a[i]=<span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb50-26"><a href="#cb50-26"></a>    mydata &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n[i],mu,sigma) </span>
<span id="cb50-27"><a href="#cb50-27"></a>    <span class="kw">Mardia</span>(mydata)</span>
<span id="cb50-28"><a href="#cb50-28"></a>  }))</span>
<span id="cb50-29"><a href="#cb50-29"></a>}</span></code></pre></div>
<p>We calculate the t1e when the sample size is 10, 20, 30, 50, 100, 500:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="kw">print</span>(a)</span></code></pre></div>
<pre><code>## [1] 0.001 0.017 0.036 0.049 0.046 0.054</code></pre>
<p>From the result we can see that t1e rate is close to 0.05 after the sample size is large than 50.</p>
<p>We further repeat Example 6.8 which evaluate the power of Mardia’s multivariate skewness test under distribution <span class="math inline">\((1-\epsilon)N(\mu_{1},\Sigma_{1})+\epsilon N(\mu_{2},\Sigma_{2})\)</span>, where: <span class="math display">\[\mu_{1}=\mu_{2}=(0,0,0)^{T}, \Sigma_{1}=\left( \begin{array}{ccc}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \end{array} \right)
\Sigma_{2}=\left( \begin{array}{ccc}
100 &amp; 0 &amp; 0 \\
0 &amp; 100 &amp; 0 \\
0 &amp; 0 &amp; 100 \end{array} \right).\]</span></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="kw">library</span>(MASS)</span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb53-3"><a href="#cb53-3"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb53-4"><a href="#cb53-4"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb53-5"><a href="#cb53-5"></a>sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb53-6"><a href="#cb53-6"></a>sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb53-7"><a href="#cb53-7"></a>sigma=<span class="kw">list</span>(sigma1,sigma2)</span>
<span id="cb53-8"><a href="#cb53-8"></a>m=<span class="dv">1000</span></span>
<span id="cb53-9"><a href="#cb53-9"></a>n=<span class="dv">50</span></span>
<span id="cb53-10"><a href="#cb53-10"></a><span class="co">#m: number of replicates; n: sample size</span></span>
<span id="cb53-11"><a href="#cb53-11"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.06</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</span>
<span id="cb53-12"><a href="#cb53-12"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb53-13"><a href="#cb53-13"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb53-14"><a href="#cb53-14"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb53-15"><a href="#cb53-15"></a>  e &lt;-<span class="st"> </span>epsilon[j]</span>
<span id="cb53-16"><a href="#cb53-16"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb53-17"><a href="#cb53-17"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb53-18"><a href="#cb53-18"></a>    index=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb53-19"><a href="#cb53-19"></a>    mydata&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>n,<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb53-20"><a href="#cb53-20"></a>    <span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb53-21"><a href="#cb53-21"></a>      <span class="cf">if</span>(index[t]<span class="op">==</span><span class="dv">1</span>) mydata[t,]=<span class="kw">mvrnorm</span>(<span class="dv">1</span>,mu1,sigma1) </span>
<span id="cb53-22"><a href="#cb53-22"></a>      <span class="cf">else</span> mydata[t,]=<span class="kw">mvrnorm</span>(<span class="dv">1</span>,mu2,sigma2)</span>
<span id="cb53-23"><a href="#cb53-23"></a>    }</span>
<span id="cb53-24"><a href="#cb53-24"></a>    sktests[i] &lt;-<span class="st"> </span><span class="kw">Mardia</span>(mydata)</span>
<span id="cb53-25"><a href="#cb53-25"></a>  }</span>
<span id="cb53-26"><a href="#cb53-26"></a>  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb53-27"><a href="#cb53-27"></a>}</span>
<span id="cb53-28"><a href="#cb53-28"></a><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb53-29"><a href="#cb53-29"></a>     <span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb53-30"><a href="#cb53-30"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb53-31"><a href="#cb53-31"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></span>
<span id="cb53-32"><a href="#cb53-32"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb53-33"><a href="#cb53-33"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>When <span class="math inline">\(\epsilon=0\)</span> or <span class="math inline">\(\epsilon=1\)</span> the distribution is multinormal, when <span class="math inline">\(0\leq \epsilon \leq 1\)</span> the empirical power of the test is greater than 0.05 and highest(close to 1) when <span class="math inline">\(0.1\leq \epsilon \leq 0.3\)</span>.</p>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<p><strong>1.What is the corresponding hypothesis test problem?</strong></p>
<p>Use <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span> denote the powers of the two different methods. The corresponding hypothesis test problem is : <span class="math display">\[H_0:p_1=p_2,\ H_1:p_1 \neq p_2\]</span></p>
<p><strong>2.What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</strong></p>
<p>We can use the Z-test,paired-t test or McNemar test.</p>
<p>Two-sample t-test is used for two independent groups, but our two methods are applied under a particular simulation setting. So we can’t use it.</p>
<p>Z-test is used to determine whether two population means are different when the variances are known and the sample size is large.</p>
<p>Paired-t test requires both variables should be normally distributed. It compares the means of two variables. It computes the difference between the two variables for each case, and tests to see if the average difference is significantly different from zero.</p>
<p>McNemar’s test is used on paired nominal data to find a change in proportion for the paired data.</p>
<p><strong>3.What information is needed to test your hypothesis?</strong></p>
<p>If use McNemar test ,the following information is needed: a: the number of experiments which is rejected by method1 but accepted by method2. b: the number of experiments which is rejected by method1 but accepted by method2. then we get the statistic:<span class="math inline">\(T_{MN}=\frac{(a-b)^2}{a+b},\ with\ T_{MN} \sim \chi^{2}(1)\)</span>.Compare it with the critical value<span class="math inline">\(\chi^{2}_\alpha(1)\)</span> with <span class="math inline">\(\alpha=0.05\)</span>,If <span class="math inline">\(T&gt;\chi^{2}_\alpha(1)\)</span>, reject <span class="math inline">\(H_0\)</span> and conclude that the powers are different <span class="math inline">\(\alpha=0.05\)</span> level.</p>
</div>
<div id="homework-5" class="section level2">
<h2>Homework 5</h2>
</div>
<div id="question-7.1" class="section level2">
<h2>Question 7.1</h2>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="kw">library</span>(bootstrap) <span class="co">#for the law data</span></span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;bootstrap&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">attach</span>(law)</span>
<span id="cb56-2"><a href="#cb56-2"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb56-3"><a href="#cb56-3"></a>R.hat&lt;-<span class="kw">cor</span>(LSAT, GPA)</span>
<span id="cb56-4"><a href="#cb56-4"></a>n&lt;-<span class="kw">dim</span>(law)[<span class="dv">1</span>]</span>
<span id="cb56-5"><a href="#cb56-5"></a>R.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb56-6"><a href="#cb56-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb56-7"><a href="#cb56-7"></a>  R.jack[i]&lt;-<span class="kw">cor</span>(LSAT[<span class="op">-</span>i],GPA[<span class="op">-</span>i])</span>
<span id="cb56-8"><a href="#cb56-8"></a>}</span>
<span id="cb56-9"><a href="#cb56-9"></a>R.bias &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(R.jack) <span class="op">-</span><span class="st"> </span>R.hat)</span>
<span id="cb56-10"><a href="#cb56-10"></a><span class="co">#jackknife estimate of bias</span></span>
<span id="cb56-11"><a href="#cb56-11"></a>R.se &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>((R.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(R.jack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb56-12"><a href="#cb56-12"></a><span class="kw">cbind</span>(<span class="st">&#39;jackknife estimate of bias&#39;</span>=R.bias,<span class="st">&#39;jackknife estimate of se&#39;</span>=R.se)</span></code></pre></div>
<pre><code>##      jackknife estimate of bias jackknife estimate of se
## [1,]               -0.006473623                0.1425186</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="kw">detach</span>(law)</span></code></pre></div>
</div>
<div id="question-7.5" class="section level2">
<h2>Question 7.5</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures 1/λ by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<p>As <span class="math inline">\(X \sim exp(\lambda)\)</span>, so <span class="math inline">\(EX=\frac{1}{\lambda}\)</span>. The likelihood function is <span class="math display">\[\begin{aligned}
F(x_1,...,x_n,\lambda)&amp;=\lambda e^{-\lambda x_1} \cdot... \lambda e^{-\lambda x_n}\\
&amp;=(\lambda)^n e^{-\lambda (x_1+..+x_n)}
\end{aligned}\]</span> The log likelihood function is<span class="math display">\[\log{F}=n\log \lambda-\lambda\sum_{i=1}^{n}x_i\]</span> <span class="math display">\[\frac{d \log{F}}{d \lambda}=\frac{n}{\lambda}-\sum_{i=1}^{n}x_i\]</span> Let<span class="math inline">\(\frac{d \log{F}}{d \lambda}=0\)</span>, then we get the MLE of <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\hat{\lambda}=\frac{1}{\bar{X}}\)</span></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb59-2"><a href="#cb59-2"></a><span class="kw">attach</span>(aircondit)</span>
<span id="cb59-3"><a href="#cb59-3"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb59-4"><a href="#cb59-4"></a>lambda.boot &lt;-<span class="st"> </span><span class="cf">function</span>(x, i) {</span>
<span id="cb59-5"><a href="#cb59-5"></a>  <span class="co">#function to compute the statistic</span></span>
<span id="cb59-6"><a href="#cb59-6"></a>  <span class="kw">mean</span>(x[i])</span>
<span id="cb59-7"><a href="#cb59-7"></a>}</span>
<span id="cb59-8"><a href="#cb59-8"></a>boot.result &lt;-<span class="st"> </span><span class="kw">boot</span>(hours, <span class="dt">statistic =</span> lambda.boot, <span class="dt">R =</span> <span class="dv">2000</span>)</span>
<span id="cb59-9"><a href="#cb59-9"></a><span class="kw">print</span>(<span class="kw">boot.ci</span>(boot.result,</span>
<span id="cb59-10"><a href="#cb59-10"></a>              <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.result, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 35.6, 182.4 )   ( 29.3, 168.9 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.3, 186.8 )   ( 56.5, 236.6 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="kw">detach</span>(aircondit)</span></code></pre></div>
</div>
<div id="question-7.8" class="section level2">
<h2>Question 7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="co">#compute theta_hat</span></span>
<span id="cb62-3"><a href="#cb62-3"></a>lambda.hat&lt;-<span class="kw">eigen</span>(<span class="kw">cov</span>(scor))<span class="op">$</span>values</span>
<span id="cb62-4"><a href="#cb62-4"></a>theta.hat&lt;-lambda.hat[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda.hat)</span>
<span id="cb62-5"><a href="#cb62-5"></a><span class="co">#number of rows</span></span>
<span id="cb62-6"><a href="#cb62-6"></a>n&lt;-<span class="kw">nrow</span>(scor)</span>
<span id="cb62-7"><a href="#cb62-7"></a><span class="co">#Jackknife method</span></span>
<span id="cb62-8"><a href="#cb62-8"></a>theta.j&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb62-9"><a href="#cb62-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb62-10"><a href="#cb62-10"></a>  x&lt;-scor[<span class="op">-</span>i,]</span>
<span id="cb62-11"><a href="#cb62-11"></a>  lambda&lt;-<span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values</span>
<span id="cb62-12"><a href="#cb62-12"></a>  theta.j[i]&lt;-lambda[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda)</span>
<span id="cb62-13"><a href="#cb62-13"></a>}</span>
<span id="cb62-14"><a href="#cb62-14"></a>bias.j&lt;-(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.j)<span class="op">-</span>theta.hat)</span>
<span id="cb62-15"><a href="#cb62-15"></a>se.j&lt;-<span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.j<span class="op">-</span><span class="kw">mean</span>(theta.j))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb62-16"><a href="#cb62-16"></a><span class="kw">cbind</span>(bias.j,se.j,theta.hat)</span></code></pre></div>
<pre><code>##           bias.j       se.j theta.hat
## [1,] 0.001069139 0.04955231  0.619115</code></pre>
</div>
<div id="question-7.11" class="section level2">
<h2>Question 7.11</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-17" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="kw">library</span>(DAAG)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;DAAG&#39;是用R版本4.0.3 来建造的</code></pre>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<pre><code>## 
## 载入程辑包：&#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="kw">attach</span>(ironslag)</span>
<span id="cb71-2"><a href="#cb71-2"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb71-3"><a href="#cb71-3"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb71-4"><a href="#cb71-4"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb71-5"><a href="#cb71-5"></a>i&lt;-<span class="dv">0</span></span>
<span id="cb71-6"><a href="#cb71-6"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb71-7"><a href="#cb71-7"></a><span class="co"># fit models on leave-one-out samples</span></span>
<span id="cb71-8"><a href="#cb71-8"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb71-9"><a href="#cb71-9"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (k<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n) {</span>
<span id="cb71-10"><a href="#cb71-10"></a>    i&lt;-i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb71-11"><a href="#cb71-11"></a>    y&lt;-magnetic[<span class="kw">c</span>(<span class="op">-</span>k,<span class="op">-</span>j)]</span>
<span id="cb71-12"><a href="#cb71-12"></a>    x &lt;-<span class="st"> </span>chemical[<span class="kw">c</span>(<span class="op">-</span>k,<span class="op">-</span>j)]</span>
<span id="cb71-13"><a href="#cb71-13"></a>    J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb71-14"><a href="#cb71-14"></a>    yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(k,j)]</span>
<span id="cb71-15"><a href="#cb71-15"></a>    e1[i] &lt;-<span class="st"> </span><span class="kw">sum</span>((magnetic[<span class="kw">c</span>(k,j)] <span class="op">-</span><span class="st"> </span>yhat1)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb71-16"><a href="#cb71-16"></a>    J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb71-17"><a href="#cb71-17"></a>    yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(k,j)] <span class="op">+</span></span>
<span id="cb71-18"><a href="#cb71-18"></a><span class="st">      </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(k,j)]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb71-19"><a href="#cb71-19"></a>    e2[i] &lt;-<span class="st"> </span><span class="kw">sum</span>((magnetic[<span class="kw">c</span>(k,j)] <span class="op">-</span><span class="st"> </span>yhat2)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb71-20"><a href="#cb71-20"></a>    J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb71-21"><a href="#cb71-21"></a>    logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(k,j)]</span>
<span id="cb71-22"><a href="#cb71-22"></a>    yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb71-23"><a href="#cb71-23"></a>    e3[i] &lt;-<span class="st"> </span><span class="kw">sum</span>((magnetic[<span class="kw">c</span>(k,j)] <span class="op">-</span><span class="st"> </span>yhat3)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb71-24"><a href="#cb71-24"></a>    J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb71-25"><a href="#cb71-25"></a>    logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[<span class="kw">c</span>(k,j)])</span>
<span id="cb71-26"><a href="#cb71-26"></a>    yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</span>
<span id="cb71-27"><a href="#cb71-27"></a>    e4[i] &lt;-<span class="st"> </span><span class="kw">sum</span>((magnetic[<span class="kw">c</span>(k,j)] <span class="op">-</span><span class="st"> </span>yhat4)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb71-28"><a href="#cb71-28"></a>  }</span>
<span id="cb71-29"><a href="#cb71-29"></a>}</span>
<span id="cb71-30"><a href="#cb71-30"></a><span class="kw">c</span>(<span class="kw">mean</span>(e1),<span class="kw">mean</span>(e2),<span class="kw">mean</span>(e3),<span class="kw">mean</span>(e4))</span></code></pre></div>
<pre><code>## [1] 39.14455 35.74037 36.90983 40.93436</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="kw">detach</span>(ironslag)</span></code></pre></div>
<p>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.</p>
</div>
<div id="homework-6" class="section level2">
<h2>Homework 6</h2>
<pre><code>## Warning: 程辑包&#39;RANN&#39;是用R版本4.0.3 来建造的</code></pre>
<pre><code>## Warning: 程辑包&#39;energy&#39;是用R版本4.0.3 来建造的</code></pre>
<pre><code>## Warning: 程辑包&#39;Ball&#39;是用R版本4.0.3 来建造的</code></pre>
<pre><code>## Warning: 程辑包&#39;ggplot2&#39;是用R版本4.0.3 来建造的</code></pre>
</div>
<div id="question-8.3" class="section level2">
<h2>Question 8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-18" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="co">#the function computes the maximum number of extreme points</span></span>
<span id="cb78-2"><a href="#cb78-2"></a>maxout &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb78-3"><a href="#cb78-3"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb78-4"><a href="#cb78-4"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb78-5"><a href="#cb78-5"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb78-6"><a href="#cb78-6"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb78-7"><a href="#cb78-7"></a>  <span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)))</span>
<span id="cb78-8"><a href="#cb78-8"></a>}</span>
<span id="cb78-9"><a href="#cb78-9"></a></span>
<span id="cb78-10"><a href="#cb78-10"></a><span class="co">#the function computes the statistics </span></span>
<span id="cb78-11"><a href="#cb78-11"></a>st&lt;-<span class="cf">function</span>(z,i,n){</span>
<span id="cb78-12"><a href="#cb78-12"></a>  x&lt;-z[i][<span class="dv">1</span><span class="op">:</span>n]</span>
<span id="cb78-13"><a href="#cb78-13"></a>  y&lt;-z[i][<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>n)]</span>
<span id="cb78-14"><a href="#cb78-14"></a>  <span class="kw">maxout</span>(x,y)</span>
<span id="cb78-15"><a href="#cb78-15"></a>}</span>
<span id="cb78-16"><a href="#cb78-16"></a><span class="co"># the function calculates p value</span></span>
<span id="cb78-17"><a href="#cb78-17"></a>c5.p&lt;-<span class="cf">function</span>(n,mu,sd){</span>
<span id="cb78-18"><a href="#cb78-18"></a>  x&lt;-<span class="kw">rnorm</span>(n[<span class="dv">1</span>],mu[<span class="dv">1</span>],sd[<span class="dv">1</span>])</span>
<span id="cb78-19"><a href="#cb78-19"></a>  y&lt;-<span class="kw">rnorm</span>(n[<span class="dv">2</span>],mu[<span class="dv">2</span>],sd[<span class="dv">2</span>])</span>
<span id="cb78-20"><a href="#cb78-20"></a>  z&lt;-<span class="kw">c</span>(x,y)</span>
<span id="cb78-21"><a href="#cb78-21"></a>  R=<span class="dv">999</span></span>
<span id="cb78-22"><a href="#cb78-22"></a>  boot.obj&lt;-<span class="kw">boot</span>(z,<span class="dt">statistic =</span> st,<span class="dt">R=</span>R,<span class="dt">sim=</span><span class="st">&#39;permutation&#39;</span>,<span class="dt">n=</span>n[<span class="dv">1</span>])</span>
<span id="cb78-23"><a href="#cb78-23"></a>  count&lt;-<span class="kw">c</span>(boot.obj<span class="op">$</span>t0, boot.obj<span class="op">$</span>t)</span>
<span id="cb78-24"><a href="#cb78-24"></a>  p.value&lt;-<span class="kw">mean</span>(count<span class="op">&gt;=</span>count[<span class="dv">1</span>])</span>
<span id="cb78-25"><a href="#cb78-25"></a>  <span class="kw">return</span>(p.value)</span>
<span id="cb78-26"><a href="#cb78-26"></a>}</span>
<span id="cb78-27"><a href="#cb78-27"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb78-28"><a href="#cb78-28"></a>n&lt;-<span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">30</span>)<span class="co">#different sample sizes</span></span>
<span id="cb78-29"><a href="#cb78-29"></a>mu&lt;-<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb78-30"><a href="#cb78-30"></a>N&lt;-<span class="dv">1000</span></span>
<span id="cb78-31"><a href="#cb78-31"></a>p&lt;-<span class="kw">numeric</span>(N)</span>
<span id="cb78-32"><a href="#cb78-32"></a></span>
<span id="cb78-33"><a href="#cb78-33"></a><span class="co"># calculate the empirical type I error rate</span></span>
<span id="cb78-34"><a href="#cb78-34"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) p[i]&lt;-<span class="kw">c5.p</span>(n,mu,<span class="dt">sd=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb78-35"><a href="#cb78-35"></a>type.<span class="fl">1.</span>error&lt;-<span class="kw">mean</span>(p<span class="op">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb78-36"><a href="#cb78-36"></a></span>
<span id="cb78-37"><a href="#cb78-37"></a><span class="co"># calculate the power</span></span>
<span id="cb78-38"><a href="#cb78-38"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) p[i]&lt;-<span class="kw">c5.p</span>(n,mu,<span class="dt">sd=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb78-39"><a href="#cb78-39"></a>e.power&lt;-<span class="kw">mean</span>(p<span class="op">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb78-40"><a href="#cb78-40"></a></span>
<span id="cb78-41"><a href="#cb78-41"></a><span class="kw">cbind</span>(type.<span class="fl">1.</span>error,e.power)</span></code></pre></div>
<pre><code>##      type.1.error e.power
## [1,]        0.041   0.805</code></pre>
</div>
<div id="design-experiments-for-evaluating-the-performance-of-the-nnenergy-and-ball-methods-in-various-situations." class="section level2">
<h2>Design experiments for evaluating the performance of the NN,energy, and ball methods in various situations.</h2>
<p><em>Unequal variances and equal expectations</em> <em>Unequal variances and unequal expectations</em> <em>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</em> <em>Unbalanced samples (say, 1 case versus 10 controls)</em> Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="co"># NN method</span></span>
<span id="cb80-2"><a href="#cb80-2"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb80-3"><a href="#cb80-3"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]</span>
<span id="cb80-4"><a href="#cb80-4"></a>  n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]</span>
<span id="cb80-5"><a href="#cb80-5"></a>  n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb80-6"><a href="#cb80-6"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb80-7"><a href="#cb80-7"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb80-8"><a href="#cb80-8"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb80-9"><a href="#cb80-9"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb80-10"><a href="#cb80-10"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb80-11"><a href="#cb80-11"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb80-12"><a href="#cb80-12"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb80-13"><a href="#cb80-13"></a>}</span>
<span id="cb80-14"><a href="#cb80-14"></a></span>
<span id="cb80-15"><a href="#cb80-15"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb80-16"><a href="#cb80-16"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb80-17"><a href="#cb80-17"></a>                   <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb80-18"><a href="#cb80-18"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb80-19"><a href="#cb80-19"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb80-20"><a href="#cb80-20"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb80-21"><a href="#cb80-21"></a>}</span>
<span id="cb80-22"><a href="#cb80-22"></a></span>
<span id="cb80-23"><a href="#cb80-23"></a></span>
<span id="cb80-24"><a href="#cb80-24"></a>m &lt;-<span class="st"> </span><span class="dv">500</span> <span class="co">#permutation</span></span>
<span id="cb80-25"><a href="#cb80-25"></a>p &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co"># dimension of data</span></span>
<span id="cb80-26"><a href="#cb80-26"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span> <span class="co">#the sample sizes</span></span>
<span id="cb80-27"><a href="#cb80-27"></a>R&lt;-<span class="dv">999</span> <span class="co">#boot parameter</span></span>
<span id="cb80-28"><a href="#cb80-28"></a>k&lt;-<span class="dv">3</span></span>
<span id="cb80-29"><a href="#cb80-29"></a>N &lt;-<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb80-30"><a href="#cb80-30"></a></span>
<span id="cb80-31"><a href="#cb80-31"></a><span class="co"># the function compares 3 methods </span></span>
<span id="cb80-32"><a href="#cb80-32"></a>meth3&lt;-<span class="cf">function</span>(n,mu,sd,m){</span>
<span id="cb80-33"><a href="#cb80-33"></a>  p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb80-34"><a href="#cb80-34"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb80-35"><a href="#cb80-35"></a>    x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n[<span class="dv">1</span>]<span class="op">*</span>p,mu[<span class="dv">1</span>],sd[<span class="dv">1</span>]),<span class="dt">ncol=</span>p);</span>
<span id="cb80-36"><a href="#cb80-36"></a>    y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n[<span class="dv">2</span>]<span class="op">*</span>p,mu[<span class="dv">2</span>],sd[<span class="dv">2</span>]),<span class="dt">ncol=</span>p);</span>
<span id="cb80-37"><a href="#cb80-37"></a>    z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb80-38"><a href="#cb80-38"></a>    <span class="co">#NN method</span></span>
<span id="cb80-39"><a href="#cb80-39"></a>    p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb80-40"><a href="#cb80-40"></a>    <span class="co">#energy method</span></span>
<span id="cb80-41"><a href="#cb80-41"></a>    p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb80-42"><a href="#cb80-42"></a>    <span class="co">#ball method</span></span>
<span id="cb80-43"><a href="#cb80-43"></a>    p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb80-44"><a href="#cb80-44"></a>    }</span>
<span id="cb80-45"><a href="#cb80-45"></a>  alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb80-46"><a href="#cb80-46"></a>  <span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb80-47"><a href="#cb80-47"></a>}</span></code></pre></div>
<p><strong>1.Unequal variances and equal expectations</strong></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb81-2"><a href="#cb81-2"></a>pow1&lt;-<span class="kw">meth3</span>(N,<span class="dt">mu=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">sd=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">1.5</span>),m)</span>
<span id="cb81-3"><a href="#cb81-3"></a>power1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">methods =</span> <span class="kw">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;Energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>),pow1)</span>
<span id="cb81-4"><a href="#cb81-4"></a>power1</span></code></pre></div>
<pre><code>##   methods  pow1
## 1      NN 0.336
## 2  Energy 0.406
## 3    Ball 0.872</code></pre>
<p><strong>The ball method has the highest power.</strong></p>
<p><strong>2.Unequal variances and unequal expectations</strong></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb83-2"><a href="#cb83-2"></a>pow2&lt;-<span class="kw">meth3</span>(N,<span class="dt">mu=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>),<span class="dt">sd=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">1.5</span>),m)</span>
<span id="cb83-3"><a href="#cb83-3"></a>power2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">methods =</span> <span class="kw">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;Energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>),pow2)</span>
<span id="cb83-4"><a href="#cb83-4"></a>power2</span></code></pre></div>
<pre><code>##   methods  pow2
## 1      NN 0.590
## 2  Energy 0.916
## 3    Ball 0.980</code></pre>
<p><strong>The ball method has the highest power.</strong></p>
<p><strong>3.Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</strong></p>
<p><strong>for mixture of two normal distributions VS normal distribution</strong></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb85-2"><a href="#cb85-2"></a>mu &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb85-3"><a href="#cb85-3"></a>sd &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb85-4"><a href="#cb85-4"></a>N&lt;-<span class="kw">c</span>(n1,n2)</span>
<span id="cb85-5"><a href="#cb85-5"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb85-6"><a href="#cb85-6"></a><span class="co">#for mixture of two normal distributions VS normal distribution</span></span>
<span id="cb85-7"><a href="#cb85-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb85-8"><a href="#cb85-8"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p),<span class="dt">ncol=</span>p)<span class="co">#t distribution with 1 df</span></span>
<span id="cb85-9"><a href="#cb85-9"></a>  y1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2<span class="op">*</span>p)</span>
<span id="cb85-10"><a href="#cb85-10"></a>  y2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dt">mean=</span>mu,<span class="dt">sd=</span>sd)</span>
<span id="cb85-11"><a href="#cb85-11"></a>  a &lt;-<span class="st"> </span><span class="kw">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">.5</span>) </span>
<span id="cb85-12"><a href="#cb85-12"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(a<span class="op">*</span>y1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>a)<span class="op">*</span>y2,<span class="dt">ncol=</span>p)<span class="co"># normal distributions mixture</span></span>
<span id="cb85-13"><a href="#cb85-13"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb85-14"><a href="#cb85-14"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb85-15"><a href="#cb85-15"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb85-16"><a href="#cb85-16"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb85-17"><a href="#cb85-17"></a>}</span>
<span id="cb85-18"><a href="#cb85-18"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb85-19"><a href="#cb85-19"></a>pow31 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb85-20"><a href="#cb85-20"></a>power31 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">methods =</span> <span class="kw">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;Energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>),pow31)</span>
<span id="cb85-21"><a href="#cb85-21"></a>power31</span></code></pre></div>
<pre><code>##   methods pow31
## 1      NN 0.394
## 2  Energy 0.514
## 3    Ball 0.708</code></pre>
<p><strong>The ball method has the highest power.</strong></p>
<p><strong>t distribution with 1 df VS normal distribution</strong></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb87-2"><a href="#cb87-2"></a>N&lt;-<span class="kw">c</span>(n1,n2)</span>
<span id="cb87-3"><a href="#cb87-3"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb87-4"><a href="#cb87-4"></a><span class="co">#t distribution with 1 df VS normal distribution</span></span>
<span id="cb87-5"><a href="#cb87-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb87-6"><a href="#cb87-6"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dt">df=</span><span class="dv">1</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb87-7"><a href="#cb87-7"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dt">sd=</span><span class="fl">1.5</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb87-8"><a href="#cb87-8"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb87-9"><a href="#cb87-9"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb87-10"><a href="#cb87-10"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb87-11"><a href="#cb87-11"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb87-12"><a href="#cb87-12"></a>}</span>
<span id="cb87-13"><a href="#cb87-13"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb87-14"><a href="#cb87-14"></a>pow32 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb87-15"><a href="#cb87-15"></a>power32 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">methods =</span> <span class="kw">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;Energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>),pow32)</span>
<span id="cb87-16"><a href="#cb87-16"></a>power32</span></code></pre></div>
<pre><code>##   methods pow32
## 1      NN 0.434
## 2  Energy 0.830
## 3    Ball 0.766</code></pre>
<p><strong>The energy method has the highest power.</strong></p>
<p><strong>t distribution with 1 df VS mixture of two normal distributions</strong></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb89-2"><a href="#cb89-2"></a>N&lt;-<span class="kw">c</span>(n1,n2)</span>
<span id="cb89-3"><a href="#cb89-3"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb89-4"><a href="#cb89-4"></a>mu&lt;-<span class="fl">0.5</span></span>
<span id="cb89-5"><a href="#cb89-5"></a>sd&lt;-<span class="dv">2</span></span>
<span id="cb89-6"><a href="#cb89-6"></a><span class="co">#t distribution with 1 df VS mixture of two normal distributions</span></span>
<span id="cb89-7"><a href="#cb89-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb89-8"><a href="#cb89-8"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dt">df=</span><span class="dv">1</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb89-9"><a href="#cb89-9"></a>  y1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2<span class="op">*</span>p)</span>
<span id="cb89-10"><a href="#cb89-10"></a>  y2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dt">mean=</span>mu,<span class="dt">sd=</span>sd)</span>
<span id="cb89-11"><a href="#cb89-11"></a>  a &lt;-<span class="st"> </span><span class="kw">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">.5</span>) </span>
<span id="cb89-12"><a href="#cb89-12"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(a<span class="op">*</span>y1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>a)<span class="op">*</span>y2,<span class="dt">ncol=</span>p)<span class="co"># normal distributions mixture</span></span>
<span id="cb89-13"><a href="#cb89-13"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb89-14"><a href="#cb89-14"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb89-15"><a href="#cb89-15"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb89-16"><a href="#cb89-16"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb89-17"><a href="#cb89-17"></a>}</span>
<span id="cb89-18"><a href="#cb89-18"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb89-19"><a href="#cb89-19"></a>pow32 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb89-20"><a href="#cb89-20"></a>power32 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">methods =</span> <span class="kw">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;Energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>),pow32)</span>
<span id="cb89-21"><a href="#cb89-21"></a>power32</span></code></pre></div>
<pre><code>##   methods pow32
## 1      NN 0.496
## 2  Energy 0.822
## 3    Ball 0.736</code></pre>
<p><strong>The energy method has the highest power.</strong></p>
<p><strong>4.Unbalanced samples (say, 1 case versus 10 controls)</strong></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb91-2"><a href="#cb91-2"></a>mu &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb91-3"><a href="#cb91-3"></a>sd &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb91-4"><a href="#cb91-4"></a>N&lt;-<span class="kw">c</span>(n1,n2<span class="op">*</span><span class="dv">10</span>)</span>
<span id="cb91-5"><a href="#cb91-5"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>) </span>
<span id="cb91-6"><a href="#cb91-6"></a><span class="co">#sample size of Y is 10 times of X</span></span>
<span id="cb91-7"><a href="#cb91-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb91-8"><a href="#cb91-8"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p),<span class="dt">ncol=</span>p);</span>
<span id="cb91-9"><a href="#cb91-9"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span><span class="dv">10</span><span class="op">*</span>p,<span class="dt">mean=</span>mu,<span class="dt">sd=</span>sd),<span class="dt">ncol=</span>p);</span>
<span id="cb91-10"><a href="#cb91-10"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb91-11"><a href="#cb91-11"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value<span class="co">#NN method</span></span>
<span id="cb91-12"><a href="#cb91-12"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value<span class="co">#energy methods</span></span>
<span id="cb91-13"><a href="#cb91-13"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value<span class="co"># ball method</span></span>
<span id="cb91-14"><a href="#cb91-14"></a>}</span>
<span id="cb91-15"><a href="#cb91-15"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</span>
<span id="cb91-16"><a href="#cb91-16"></a>pow4 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb91-17"><a href="#cb91-17"></a>power4 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">methods =</span> <span class="kw">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;Energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>),pow4)</span>
<span id="cb91-18"><a href="#cb91-18"></a>power4</span></code></pre></div>
<pre><code>##   methods  pow4
## 1      NN 0.302
## 2  Energy 0.990
## 3    Ball 0.930</code></pre>
<p><strong>The energy method has the highest power.</strong></p>
<p><strong>From the results above, we can see that the ball method and the energy method perform better than NN method, but can not claim which of they two is better, it depends on different conditions.</strong></p>
</div>
<div id="homework-7" class="section level2">
<h2>Homework 7</h2>
</div>
<div id="question-9.4" class="section level2">
<h2>Question 9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-19" class="section level2">
<h2>Answer</h2>
<p>The standard Laplace distribution density is <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|}\)</span>. First construct a function to generate the chain, given the parameter <span class="math inline">\(\sigma\)</span>, initial value <span class="math inline">\(X_0\)</span>, and the length of the chain <span class="math inline">\(N\)</span>.<span class="math inline">\(Var(X)=2.\)</span></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>rw.M &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb93-2"><a href="#cb93-2"></a>x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb93-3"><a href="#cb93-3"></a>x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb93-4"><a href="#cb93-4"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb93-5"><a href="#cb93-5"></a>k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb93-6"><a href="#cb93-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb93-7"><a href="#cb93-7"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb93-8"><a href="#cb93-8"></a><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="kw">abs</span>(y)))) x[i] &lt;-<span class="st"> </span>y </span>
<span id="cb93-9"><a href="#cb93-9"></a><span class="cf">else</span> {</span>
<span id="cb93-10"><a href="#cb93-10"></a>x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb93-11"><a href="#cb93-11"></a>k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb93-12"><a href="#cb93-12"></a>}</span>
<span id="cb93-13"><a href="#cb93-13"></a>}</span>
<span id="cb93-14"><a href="#cb93-14"></a><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb93-15"><a href="#cb93-15"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a>N &lt;-<span class="st"> </span><span class="dv">4500</span></span>
<span id="cb94-2"><a href="#cb94-2"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)<span class="co">#different variances</span></span>
<span id="cb94-3"><a href="#cb94-3"></a>x0 &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb94-4"><a href="#cb94-4"></a>k &lt;-<span class="st"> </span><span class="kw">length</span>(sigma)</span>
<span id="cb94-5"><a href="#cb94-5"></a>rw&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dt">ncol =</span> N,<span class="dt">nrow =</span> k)<span class="co"># random walk chains</span></span>
<span id="cb94-6"><a href="#cb94-6"></a>accept.rate&lt;-<span class="kw">numeric</span>(k)<span class="co"># acceptance rate</span></span>
<span id="cb94-7"><a href="#cb94-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sigma)) {</span>
<span id="cb94-8"><a href="#cb94-8"></a>  rw[i,] &lt;-<span class="st"> </span><span class="kw">rw.M</span>(sigma[i], x0, N)<span class="op">$</span>x</span>
<span id="cb94-9"><a href="#cb94-9"></a>  accept.rate[i] &lt;-<span class="st"> </span>(N<span class="op">-</span><span class="kw">rw.M</span>(sigma[i], x0, N)<span class="op">$</span>k)<span class="op">/</span>N</span>
<span id="cb94-10"><a href="#cb94-10"></a>}</span>
<span id="cb94-11"><a href="#cb94-11"></a><span class="kw">rbind</span>(<span class="st">&#39;sigma&#39;</span>=sigma,<span class="st">&#39;acceptance rate&#39;</span>=accept.rate)</span></code></pre></div>
<pre><code>##                      [,1]      [,2]  [,3]        [,4]
## sigma           0.0500000 0.5000000 2.000 16.00000000
## acceptance rate 0.9813333 0.8242222 0.526  0.09822222</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sigma)) {</span>
<span id="cb96-2"><a href="#cb96-2"></a>  <span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(rw[i,]),rw[i,],<span class="st">&quot;l&quot;</span>,<span class="dt">ylab =</span> <span class="st">&#39;x&#39;</span>,<span class="dt">xlab =</span> <span class="st">&#39;sigma&#39;</span>)</span>
<span id="cb96-3"><a href="#cb96-3"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAXVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6kNtmAABmADpmOpBmtrZmtttmtv+QOgCQOmaQZgCQkGaQ2/+2ZgC2tma225C2///bkDrb2//b////tmb/25D//7b//9v///8DXVu7AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAH9klEQVR4nO2di3bjJhRFbzJJ4z4mbaN21HEc/v8zqxcIkNABCdnYOnutZhQbjsQ2QraDqCiyiNz6AEqHggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBAgRdDl9Nb8PIvI84+9jqc4kgXV3362W993O6LCSBU0qOk0HYJUQZ+vnaDzYU6yzD1I7oZ9BLXJL0oP1xvjbsouglTn6OmjuZAF/FDQleP248qCvFP7DjTtJKhuFPSDdOAqdnBBdTP+XE7tKE1Bc3y9v3U/m0s8Bc2hP2BU335S0Bx9D2qoXihoFq2leTdEQbPU/TWs6UsUtGW/FITiyjdEQQAKAlAQgIIAFASgIMBtvw+iIBRHQSCOgkAcBYE4CgJxFATiKAjEURCIoyAQR0EgjoJAHAWBOAoCcRQE4ijIT+HXHWlxFATiKAjEURCIoyAQR0Eg7rCCvt77i3nwRoSDC6r1BPLgTPJjCzJT8Bbu1UhPvQ27CLLuEgvd7XNsQexBCD1FkWNQiP6GKJHg/YZHFxQbR0F+SvrXHTd2WH4PujtBX/9l3O8jCupvc2pE/Rm8n1kP0QsfNh5YUHPpfvpor+QLN3wH70Dw4x5S0PBJNHS77lDkJSruMQV1hsCSE2dQ4KEFVSJ/vIffA6bEPaKgZgTu13bZtOjEIwv6re86C1ex+LhHFJR1vxQE4igIxFEQiKMgEEdBfsqKrzvS97xUIzXtDnpQ1J4l+Iv3aETBcHCWgklxyYIkUMktNBubKCj1O88dBS1H7y0otPeiBdmPZBUk0+jQ+XgvgiRKkCwLMrtx0wKCHJMFChIoaNowu5Q4gsT54a775+WI82hhgsT51RXktzdCkNdqV5BeQM3PuT9B0jdWrD6RQVD3rMhdCRIjSBYE9S30BYlRojuGfSKJ5UalCRL7wegW5cITJCsEiflvTpDoTeXWjBMkxQgSqz1JgsQWZBqtZgXZlcKC5JqCoqfgGUFD48QMnsOZZwSJP4ggQZZZEVeQjIKsk/GKguKn4E0F6dYOJ47dWEvQpC/MCBoHp1HXiLI39L61mZ0FJUygShAkc4LEEeQI04JmnHiCnHLKhO4nKDwFzzoOX5D9Us9YmDRwvpC7C9vBoiA74QqC1vSgfnC2usyMjdnGz3szZfS54/Y55b0S7rC1u6CEKXizLbYGUedJa6Sdq2r+sWuNu/MEWXb7EhPTOwqKn4I3vnpqvDKNjdDnhnUa2M+aquYZO3ZZkGV1PKrxzcHOgmLjrNYpJEjZ13Wr6oKgcT/KDPv6ahgUpMoVpB8yI5IygpQryFRVQJC1u4kgHT0VpFQxgoZjWRZkFw0KUr6g6S4Dgpx9m2OzjzChRblYFKQ/bUxfSm1FTQSZZ4eNGEFqXtD0CBNalAsoyHrW/0WUvemqMWWDgpQtKPIIE1qUC2f3i4JcW3Yl5VZy048naNxeKcjsyVcdcYQR7CloeWfrBAWCXUHrjzBYPhcJu5+U2SIoucGHExTN/QgK1JWFuvcryPskuCV1laAVu8leMCmOgkAcBYG4zKk7QEEACgLsJIhLUyzDpSmW4cICAC5NAWAPQnBpCgSXprjafm8NBQEoCHDj74PKZ6f3QaOI0Pugu2EPQRFLU0SHllQkY324NEV0aElFctZHS1NEh5ZUZNf6a0NLKrJr/bWhJRXJXd/6zLo+tKQiuetTEICCABQEwIIeibv58HQrKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgLkF3SWbuXuZLrZa29OwnQjiqqbOrA1ZSC7oHNzDOcVhr7em0q1vFgJ0424I+jmVmxN0eQW1H8XUkX9dcjh87X9e0n9/MMkTDeiuJxaQVtTDLkFmXauq968wiZhuhEVUX/7qxG0NcWQXdAvbR8OzdCDVE1DdMJ0I/IA2jFoY8pIbkH9Sb5mEOpqN6O0SZhuRCS0J1IraFuKRVGCznqMXt+0dvJk0YK2nGL9zMdNJ0dXtOhTbMMgPUxT3zS81sPklu/FDtKrL/NmCu32C3RV8mV+9RvFz1f9x6TNb/Gqkt8odr18zRA9nBz9/19oSJhuRNF/1NiaMsAPqwAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQoExB1np7t6ZMQQVBQYDCBH2+ttPDhlOsEnn6u50X/PtJ5K19ang0agmaTJQlqJsmd5bvnaDq+Uez3Qrq5uA3v7Xz59opYvXKSbRrKEuQnmLZCurnFFatoLdhAlrz0OXXDz2N8TqUJehy6g21gnpZeur9+KO7KeWogvpbfvoxqJ4XVIs8/3vYHtTRnFXhHmT3pKtQoKDGzjgG1Z6gTlvcSmp5KEuQnq7rXcW8HnQ5hRYj3oGyBLXjbztV17wPev5nmCJvj0FPH9X1rvOFCZqw+saqXJQrqOszl9OtF3MqV1B3ul3zQ8U8BQsqAwoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQE+B9bTJLUk/VGigAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="for-exercise-9.4" class="section level2">
<h2>For Exercise 9.4,</h2>
<p>use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R} &lt; 1.2\)</span>.</p>
</div>
<div id="answer-20" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a>l.chain &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, N, X1) {</span>
<span id="cb97-2"><a href="#cb97-2"></a><span class="co">#generates a Metropolis chain for the standard Laplace distribution with Normal(X[t], sigma) proposal distribution and starting value X1</span></span>
<span id="cb97-3"><a href="#cb97-3"></a>x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb97-4"><a href="#cb97-4"></a>x[<span class="dv">1</span>] &lt;-<span class="st"> </span>X1</span>
<span id="cb97-5"><a href="#cb97-5"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb97-6"><a href="#cb97-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb97-7"><a href="#cb97-7"></a>xt &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb97-8"><a href="#cb97-8"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, xt, sigma) <span class="co">#candidate point</span></span>
<span id="cb97-9"><a href="#cb97-9"></a><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="kw">abs</span>(y))))</span>
<span id="cb97-10"><a href="#cb97-10"></a>x[i] &lt;-<span class="st"> </span>y </span>
<span id="cb97-11"><a href="#cb97-11"></a><span class="cf">else</span> {</span>
<span id="cb97-12"><a href="#cb97-12"></a>x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb97-13"><a href="#cb97-13"></a>k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb97-14"><a href="#cb97-14"></a>}</span>
<span id="cb97-15"><a href="#cb97-15"></a>}</span>
<span id="cb97-16"><a href="#cb97-16"></a><span class="kw">return</span>(x)</span>
<span id="cb97-17"><a href="#cb97-17"></a>}</span>
<span id="cb97-18"><a href="#cb97-18"></a></span>
<span id="cb97-19"><a href="#cb97-19"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb97-20"><a href="#cb97-20"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb97-21"><a href="#cb97-21"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb97-22"><a href="#cb97-22"></a>psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb97-23"><a href="#cb97-23"></a>n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb97-24"><a href="#cb97-24"></a>k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb97-25"><a href="#cb97-25"></a>psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb97-26"><a href="#cb97-26"></a>B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb97-27"><a href="#cb97-27"></a>psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb97-28"><a href="#cb97-28"></a>W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb97-29"><a href="#cb97-29"></a>v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb97-30"><a href="#cb97-30"></a>r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic</span></span>
<span id="cb97-31"><a href="#cb97-31"></a><span class="kw">return</span>(r.hat)</span>
<span id="cb97-32"><a href="#cb97-32"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>sigma &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co">#parameter of proposal distribution</span></span>
<span id="cb98-2"><a href="#cb98-2"></a>k &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb98-3"><a href="#cb98-3"></a>n &lt;-<span class="st"> </span><span class="dv">3500</span> <span class="co">#length of chains</span></span>
<span id="cb98-4"><a href="#cb98-4"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb98-5"><a href="#cb98-5"></a><span class="co">#choose over dispersed initial values</span></span>
<span id="cb98-6"><a href="#cb98-6"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb98-7"><a href="#cb98-7"></a><span class="co">#generate the chains</span></span>
<span id="cb98-8"><a href="#cb98-8"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</span>
<span id="cb98-9"><a href="#cb98-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) X[i, ] &lt;-<span class="st"> </span><span class="kw">l.chain</span>(sigma, n, x0[i])</span>
<span id="cb98-10"><a href="#cb98-10"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb98-11"><a href="#cb98-11"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb98-12"><a href="#cb98-12"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi)) psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb98-13"><a href="#cb98-13"></a><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.165063</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb100-2"><a href="#cb100-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb100-3"><a href="#cb100-3"></a><span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span>
<span id="cb101-2"><a href="#cb101-2"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb101-3"><a href="#cb101-3"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb101-4"><a href="#cb101-4"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</span>
<span id="cb101-5"><a href="#cb101-5"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb101-6"><a href="#cb101-6"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb101-7"><a href="#cb101-7"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-11.4" class="section level2">
<h2>Question 11.4</h2>
<p>Find the intersection points A(k) in <span class="math inline">\((0,\sqrt{k})\)</span> of the curves <span class="math display">\[S_{k-1}(a)=P\left(t(k-1)&gt;\sqrt{\frac{a^{2}(k-1)}{k-a^{2}}}\right)\]</span>and <span class="math display">\[S_{k}(a)=P\left(t(k)&gt;\sqrt{\frac{a^{2} k}{k+1-a^{2}}}\right)\]</span> for k = 4 : 25, 100, 500, 1000, where t(k) is a Student t random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Sz´ekely [260].)</p>
</div>
<div id="answer-21" class="section level2">
<h2>Answer</h2>
<p>From the plot we can guess that the intersection points of the cuves are approximately in the interval [0.5,2].</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a>k&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb102-2"><a href="#cb102-2"></a>sk&lt;-<span class="cf">function</span>(a,ki){</span>
<span id="cb102-3"><a href="#cb102-3"></a>  <span class="kw">pt</span>(<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(ki<span class="dv">-1</span>))<span class="op">/</span>(ki<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>ki<span class="dv">-1</span>)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>ki)<span class="op">/</span>(ki<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>ki)</span>
<span id="cb102-4"><a href="#cb102-4"></a>  }</span>
<span id="cb102-5"><a href="#cb102-5"></a>out&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(k))</span>
<span id="cb102-6"><a href="#cb102-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)) {</span>
<span id="cb102-7"><a href="#cb102-7"></a>   out[i]&lt;-<span class="kw">uniroot</span>(sk, <span class="dt">lower =</span> <span class="fl">0.5</span>, <span class="dt">upper =</span> <span class="dv">2</span>,<span class="dt">ki =</span> k[i])<span class="op">$</span>root</span>
<span id="cb102-8"><a href="#cb102-8"></a>}</span>
<span id="cb102-9"><a href="#cb102-9"></a><span class="kw">cbind</span>(k,out)</span></code></pre></div>
<pre><code>##          k      out
##  [1,]    4 1.492105
##  [2,]    5 1.533558
##  [3,]    6 1.562774
##  [4,]    7 1.584418
##  [5,]    8 1.601170
##  [6,]    9 1.614507
##  [7,]   10 1.625375
##  [8,]   11 1.634403
##  [9,]   12 1.642021
## [10,]   13 1.648536
## [11,]   14 1.654172
## [12,]   15 1.659094
## [13,]   16 1.663431
## [14,]   17 1.667282
## [15,]   18 1.670723
## [16,]   19 1.673816
## [17,]   20 1.676613
## [18,]   21 1.679153
## [19,]   22 1.681471
## [20,]   23 1.683594
## [21,]   24 1.685546
## [22,]   25 1.687346
## [23,]  100 1.720585
## [24,]  500 1.729759
## [25,] 1000 1.730908</code></pre>
</div>
<div id="homework-8" class="section level2">
<h2>Homework 8</h2>
</div>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p><strong>Use EM algorithm to solve MLE of p and q (consider missing data nAA and nBB).Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</strong></p>
</div>
<div id="answer-22" class="section level2">
<h2>Answer</h2>
<p>For observed data, <span class="math display">\[\begin{aligned}
L_O(p,q)=(p^2+2pr)^{n_{A.}}(q^2+2qr)^{n_{B.}}(r^2)^{n_{OO}}(2pq)^{n_{AB}}
\end{aligned}\]</span></p>
<p>For complete data, <span class="math display">\[L_C(p,q)=(p^2)^{n_{AA}}(q^2)^{n_{BB}}(r^2)^{n_{OO}}(2pr)^{n_{AO}}(2qr)^{n_{BO}}(2pq)^{n_{AB}}\]</span> Use the EM algorithm,we have <span class="math inline">\(p^{t+1}=\frac{2n^{t}_{A.}-n^{t}_{AO}+n^{t}_{AB}}{2n}\)</span>, <span class="math inline">\(q^{t+1}=\frac{2n^{t}_{B.}-n^{t}_{BO}+n^{t}_{AB}}{2n}\)</span>, <span class="math inline">\(r^{t+1}=1-p^{t+1}-q^{t+1}\)</span>.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb104-2"><a href="#cb104-2"></a>N &lt;-<span class="st"> </span><span class="dv">5000</span> <span class="co">#max. number of iterations</span></span>
<span id="cb104-3"><a href="#cb104-3"></a>pqr &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.4</span>, <span class="fl">.1</span>) <span class="co">#initial est. for lambdas</span></span>
<span id="cb104-4"><a href="#cb104-4"></a>tol &lt;-<span class="st"> </span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span></span>
<span id="cb104-5"><a href="#cb104-5"></a>na.&lt;-<span class="dv">444</span></span>
<span id="cb104-6"><a href="#cb104-6"></a>nb.&lt;-<span class="dv">132</span></span>
<span id="cb104-7"><a href="#cb104-7"></a>noo&lt;-<span class="dv">361</span></span>
<span id="cb104-8"><a href="#cb104-8"></a>nab&lt;-<span class="dv">63</span></span>
<span id="cb104-9"><a href="#cb104-9"></a>n&lt;-na.<span class="op">+</span>nb.<span class="op">+</span>noo<span class="op">+</span>nab</span>
<span id="cb104-10"><a href="#cb104-10"></a>pqr&lt;-<span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.4</span>,<span class="fl">0.1</span>)</span>
<span id="cb104-11"><a href="#cb104-11"></a>pqrn&lt;-pqr<span class="op">+</span><span class="dv">1</span></span>
<span id="cb104-12"><a href="#cb104-12"></a>l.pqr&lt;-<span class="cf">function</span>(x){</span>
<span id="cb104-13"><a href="#cb104-13"></a>  p&lt;-x[<span class="dv">1</span>];q&lt;-x[<span class="dv">2</span>];r&lt;-x[<span class="dv">3</span>]</span>
<span id="cb104-14"><a href="#cb104-14"></a>  na.<span class="op">*</span><span class="kw">log</span>(p<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)<span class="op">+</span>nb.<span class="op">*</span><span class="kw">log</span>(q<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>noo<span class="op">*</span><span class="kw">log</span>(r)<span class="op">+</span>nab<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q)</span>
<span id="cb104-15"><a href="#cb104-15"></a>}</span>
<span id="cb104-16"><a href="#cb104-16"></a>PQR&lt;-<span class="kw">c</span>(<span class="st">&#39;p&#39;</span>=pqr[<span class="dv">1</span>],<span class="st">&#39;q&#39;</span>=pqr[<span class="dv">2</span>],<span class="dt">llhd=</span><span class="kw">l.pqr</span>(pqr))</span>
<span id="cb104-17"><a href="#cb104-17"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</span>
<span id="cb104-18"><a href="#cb104-18"></a>  nao.t&lt;-na.<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>pqr[<span class="dv">3</span>]<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>pqr[<span class="dv">3</span>]<span class="op">+</span>pqr[<span class="dv">1</span>]))</span>
<span id="cb104-19"><a href="#cb104-19"></a>  nbo.t&lt;-nb.<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>pqr[<span class="dv">3</span>]<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>pqr[<span class="dv">3</span>]<span class="op">+</span>pqr[<span class="dv">2</span>]))</span>
<span id="cb104-20"><a href="#cb104-20"></a>  naa.t&lt;-na.<span class="op">*</span>(pqr[<span class="dv">1</span>]<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>pqr[<span class="dv">3</span>]<span class="op">+</span>pqr[<span class="dv">1</span>]))</span>
<span id="cb104-21"><a href="#cb104-21"></a>  nbb.t&lt;-nb.<span class="op">*</span>(pqr[<span class="dv">2</span>]<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>pqr[<span class="dv">3</span>]<span class="op">+</span>pqr[<span class="dv">2</span>]))</span>
<span id="cb104-22"><a href="#cb104-22"></a>  na.&lt;-nao.t<span class="op">+</span>naa.t</span>
<span id="cb104-23"><a href="#cb104-23"></a>  nb.&lt;-nbo.t<span class="op">+</span>nbb.t</span>
<span id="cb104-24"><a href="#cb104-24"></a>  pqrn[<span class="dv">1</span>]&lt;-(<span class="dv">2</span><span class="op">*</span>na.<span class="op">-</span>nao.t<span class="op">+</span>nab)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</span>
<span id="cb104-25"><a href="#cb104-25"></a>  pqrn[<span class="dv">2</span>]&lt;-(<span class="dv">2</span><span class="op">*</span>nb.<span class="op">-</span>nbo.t<span class="op">+</span>nab)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</span>
<span id="cb104-26"><a href="#cb104-26"></a>  pqrn[<span class="dv">3</span>]&lt;-<span class="dv">1</span><span class="op">-</span>pqr[<span class="dv">1</span>]<span class="op">-</span>pqr[<span class="dv">2</span>]</span>
<span id="cb104-27"><a href="#cb104-27"></a>  <span class="cf">if</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(pqr<span class="op">-</span>pqrn)<span class="op">/</span>pqr) <span class="op">&lt;</span><span class="st"> </span>tol) <span class="cf">break</span></span>
<span id="cb104-28"><a href="#cb104-28"></a>  pqr &lt;-<span class="st"> </span>pqrn</span>
<span id="cb104-29"><a href="#cb104-29"></a>  PQR&lt;-<span class="kw">rbind</span>(PQR,<span class="kw">c</span>(pqr[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],<span class="kw">l.pqr</span>(pqr)))</span>
<span id="cb104-30"><a href="#cb104-30"></a>}</span>
<span id="cb104-31"><a href="#cb104-31"></a>PQR&lt;-<span class="kw">cbind</span>(<span class="dv">1</span><span class="op">-</span>PQR[,<span class="dv">1</span>]<span class="op">-</span>PQR[,<span class="dv">2</span>],PQR)</span>
<span id="cb104-32"><a href="#cb104-32"></a><span class="kw">rownames</span>(PQR)&lt;-<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>i)</span>
<span id="cb104-33"><a href="#cb104-33"></a><span class="kw">colnames</span>(PQR)&lt;-<span class="kw">c</span>(<span class="st">&#39;r&#39;</span>,<span class="st">&#39;p&#39;</span>,<span class="st">&#39;q&#39;</span>,<span class="st">&#39;log likelihood value&#39;</span>)</span>
<span id="cb104-34"><a href="#cb104-34"></a>knitr<span class="op">::</span><span class="kw">kable</span>(PQR)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">r</th>
<th align="right">p</th>
<th align="right">q</th>
<th align="right">log likelihood value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1000000</td>
<td align="right">0.5000000</td>
<td align="right">0.4000000</td>
<td align="right">-2374.693</td>
</tr>
<tr class="even">
<td align="right">0.4464286</td>
<td align="right">0.4120714</td>
<td align="right">0.1415000</td>
<td align="right">-2809.381</td>
</tr>
<tr class="odd">
<td align="right">0.4721936</td>
<td align="right">0.4029594</td>
<td align="right">0.1248470</td>
<td align="right">-1287.784</td>
</tr>
<tr class="even">
<td align="right">0.5718682</td>
<td align="right">0.3225352</td>
<td align="right">0.1055966</td>
<td align="right">-1398.689</td>
</tr>
<tr class="odd">
<td align="right">0.5858453</td>
<td align="right">0.3100171</td>
<td align="right">0.1041376</td>
<td align="right">-1199.327</td>
</tr>
<tr class="even">
<td align="right">0.5961500</td>
<td align="right">0.3008421</td>
<td align="right">0.1030078</td>
<td align="right">-1190.745</td>
</tr>
<tr class="odd">
<td align="right">0.5983114</td>
<td align="right">0.2988552</td>
<td align="right">0.1028334</td>
<td align="right">-1174.166</td>
</tr>
<tr class="even">
<td align="right">0.5992667</td>
<td align="right">0.2979929</td>
<td align="right">0.1027404</td>
<td align="right">-1171.735</td>
</tr>
<tr class="odd">
<td align="right">0.5995196</td>
<td align="right">0.2977618</td>
<td align="right">0.1027186</td>
<td align="right">-1170.328</td>
</tr>
<tr class="even">
<td align="right">0.5996122</td>
<td align="right">0.2976779</td>
<td align="right">0.1027099</td>
<td align="right">-1170.007</td>
</tr>
<tr class="odd">
<td align="right">0.5996395</td>
<td align="right">0.2976530</td>
<td align="right">0.1027075</td>
<td align="right">-1169.876</td>
</tr>
<tr class="even">
<td align="right">0.5996488</td>
<td align="right">0.2976445</td>
<td align="right">0.1027066</td>
<td align="right">-1169.840</td>
</tr>
<tr class="odd">
<td align="right">0.5996517</td>
<td align="right">0.2976419</td>
<td align="right">0.1027064</td>
<td align="right">-1169.827</td>
</tr>
<tr class="even">
<td align="right">0.5996526</td>
<td align="right">0.2976411</td>
<td align="right">0.1027063</td>
<td align="right">-1169.823</td>
</tr>
<tr class="odd">
<td align="right">0.5996529</td>
<td align="right">0.2976408</td>
<td align="right">0.1027063</td>
<td align="right">-1169.822</td>
</tr>
<tr class="even">
<td align="right">0.5996530</td>
<td align="right">0.2976407</td>
<td align="right">0.1027063</td>
<td align="right">-1169.822</td>
</tr>
<tr class="odd">
<td align="right">0.5996531</td>
<td align="right">0.2976407</td>
<td align="right">0.1027063</td>
<td align="right">-1169.822</td>
</tr>
<tr class="even">
<td align="right">0.5996531</td>
<td align="right">0.2976407</td>
<td align="right">0.1027063</td>
<td align="right">-1169.822</td>
</tr>
<tr class="odd">
<td align="right">0.5996531</td>
<td align="right">0.2976407</td>
<td align="right">0.1027063</td>
<td align="right">-1169.822</td>
</tr>
</tbody>
</table>
<p><strong>From the table above we can see that the corresponding log-maximum likelihood values are increasing.</strong></p>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p><strong>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</strong> formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt, mpg ~ I(1 / disp) + wt )</p>
</div>
<div id="answer-23" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb105-2"><a href="#cb105-2"></a>  mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb105-3"><a href="#cb105-3"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb105-4"><a href="#cb105-4"></a>  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb105-5"><a href="#cb105-5"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb105-6"><a href="#cb105-6"></a>)</span>
<span id="cb105-7"><a href="#cb105-7"></a></span>
<span id="cb105-8"><a href="#cb105-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(formulas)){</span>
<span id="cb105-9"><a href="#cb105-9"></a>  out&lt;-<span class="kw">lm</span>(formulas[[i]],mtcars)</span>
<span id="cb105-10"><a href="#cb105-10"></a>  <span class="kw">print</span>(out)</span>
<span id="cb105-11"><a href="#cb105-11"></a>}</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="kw">lapply</span>(formulas,<span class="cf">function</span>(l) <span class="kw">lm</span>(l,mtcars))</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = l, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = l, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = l, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = l, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p><strong>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</strong> trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE ) Extra challenge: get rid of the anonymous function by using [[ directly.</p>
</div>
<div id="answer-24" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="co">#using sapply</span></span>
<span id="cb109-2"><a href="#cb109-2"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>,</span>
<span id="cb109-3"><a href="#cb109-3"></a>                    <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb109-4"><a href="#cb109-4"></a>                    <span class="dt">simplify =</span> <span class="ot">FALSE</span>)</span>
<span id="cb109-5"><a href="#cb109-5"></a><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="op">$</span>p.value)</span></code></pre></div>
<pre><code>##   [1] 9.813226e-01 1.619096e-05 6.242135e-01 6.693526e-01 5.677105e-01
##   [6] 6.610740e-01 5.951636e-01 5.005347e-01 4.763110e-01 3.429965e-01
##  [11] 8.155394e-01 7.197238e-01 1.244336e-01 2.229164e-01 1.113099e-02
##  [16] 4.625765e-01 6.515865e-01 1.658793e-01 9.342672e-01 8.011934e-01
##  [21] 4.627657e-01 5.927934e-01 2.929669e-01 5.737967e-01 3.451537e-02
##  [26] 2.739138e-01 2.656151e-01 8.196695e-01 6.647355e-01 8.056529e-01
##  [31] 5.060850e-01 7.106543e-01 2.321066e-01 1.106223e-01 5.459279e-01
##  [36] 1.865470e-02 2.433776e-01 2.688851e-01 9.819256e-01 4.940184e-01
##  [41] 3.268275e-01 8.000439e-01 9.822499e-01 1.936454e-01 7.390101e-01
##  [46] 3.888930e-02 4.350424e-01 7.434339e-02 5.787441e-01 4.864951e-01
##  [51] 1.476288e-01 5.524909e-01 7.129280e-01 8.683479e-03 9.053256e-02
##  [56] 4.415463e-01 4.955063e-01 1.745328e-01 6.615399e-01 4.479199e-01
##  [61] 2.885849e-01 3.028567e-02 1.018907e-01 1.811861e-02 6.376441e-01
##  [66] 1.408742e-02 9.008128e-02 4.515933e-01 8.703291e-01 7.250768e-01
##  [71] 8.183571e-01 8.465036e-01 8.786838e-01 1.651543e-01 3.951569e-01
##  [76] 1.754280e-01 3.649865e-01 7.224226e-02 6.565152e-01 9.946559e-01
##  [81] 3.715952e-01 8.424336e-02 4.549887e-01 8.530113e-01 1.970777e-01
##  [86] 2.298117e-01 1.148832e-01 7.769502e-01 4.934348e-01 3.526049e-01
##  [91] 2.036013e-01 8.838914e-01 6.474880e-02 4.089082e-01 5.780132e-01
##  [96] 8.011408e-01 5.956061e-01 9.266689e-01 9.923205e-02 1.763972e-01</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="co">#using [[ directly</span></span>
<span id="cb111-2"><a href="#cb111-2"></a><span class="kw">sapply</span>(trials, <span class="st">&#39;[[&#39;</span> ,<span class="st">&#39;p.value&#39;</span>)</span></code></pre></div>
<pre><code>##   [1] 9.813226e-01 1.619096e-05 6.242135e-01 6.693526e-01 5.677105e-01
##   [6] 6.610740e-01 5.951636e-01 5.005347e-01 4.763110e-01 3.429965e-01
##  [11] 8.155394e-01 7.197238e-01 1.244336e-01 2.229164e-01 1.113099e-02
##  [16] 4.625765e-01 6.515865e-01 1.658793e-01 9.342672e-01 8.011934e-01
##  [21] 4.627657e-01 5.927934e-01 2.929669e-01 5.737967e-01 3.451537e-02
##  [26] 2.739138e-01 2.656151e-01 8.196695e-01 6.647355e-01 8.056529e-01
##  [31] 5.060850e-01 7.106543e-01 2.321066e-01 1.106223e-01 5.459279e-01
##  [36] 1.865470e-02 2.433776e-01 2.688851e-01 9.819256e-01 4.940184e-01
##  [41] 3.268275e-01 8.000439e-01 9.822499e-01 1.936454e-01 7.390101e-01
##  [46] 3.888930e-02 4.350424e-01 7.434339e-02 5.787441e-01 4.864951e-01
##  [51] 1.476288e-01 5.524909e-01 7.129280e-01 8.683479e-03 9.053256e-02
##  [56] 4.415463e-01 4.955063e-01 1.745328e-01 6.615399e-01 4.479199e-01
##  [61] 2.885849e-01 3.028567e-02 1.018907e-01 1.811861e-02 6.376441e-01
##  [66] 1.408742e-02 9.008128e-02 4.515933e-01 8.703291e-01 7.250768e-01
##  [71] 8.183571e-01 8.465036e-01 8.786838e-01 1.651543e-01 3.951569e-01
##  [76] 1.754280e-01 3.649865e-01 7.224226e-02 6.565152e-01 9.946559e-01
##  [81] 3.715952e-01 8.424336e-02 4.549887e-01 8.530113e-01 1.970777e-01
##  [86] 2.298117e-01 1.148832e-01 7.769502e-01 4.934348e-01 3.526049e-01
##  [91] 2.036013e-01 8.838914e-01 6.474880e-02 4.089082e-01 5.780132e-01
##  [96] 8.011408e-01 5.956061e-01 9.266689e-01 9.923205e-02 1.763972e-01</code></pre>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p><strong>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</strong></p>
</div>
<div id="answer-25" class="section level2">
<h2>Answer</h2>
<p>we construct a list which the elements of it is also list.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a>testset &lt;-<span class="st"> </span><span class="kw">list</span>(mtcars, cars)</span>
<span id="cb113-2"><a href="#cb113-2"></a><span class="kw">lapply</span>(testset, <span class="cf">function</span>(x) <span class="kw">vapply</span>(x, mean, <span class="kw">numeric</span>(<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## [[1]]
##        mpg        cyl       disp         hp       drat         wt       qsec 
##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
##         vs         am       gear       carb 
##   0.437500   0.406250   3.687500   2.812500 
## 
## [[2]]
## speed  dist 
## 15.40 42.98</code></pre>
<p>then use a combination of Map() and vapply()</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a>mvapply &lt;-<span class="st"> </span><span class="cf">function</span>(X, f, f.value, <span class="dt">simplify =</span> <span class="ot">FALSE</span>){</span>
<span id="cb115-2"><a href="#cb115-2"></a>  out &lt;-<span class="st"> </span><span class="kw">Map</span>(<span class="cf">function</span>(x) <span class="kw">vapply</span>(x, f, f.value), X)</span>
<span id="cb115-3"><a href="#cb115-3"></a>  <span class="cf">if</span>(simplify <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){<span class="kw">return</span>(<span class="kw">simplify2array</span>(out))}</span>
<span id="cb115-4"><a href="#cb115-4"></a>  out&lt;-<span class="kw">unlist</span>(out)</span>
<span id="cb115-5"><a href="#cb115-5"></a>  <span class="kw">return</span>(out)</span>
<span id="cb115-6"><a href="#cb115-6"></a>}</span>
<span id="cb115-7"><a href="#cb115-7"></a><span class="kw">mvapply</span>(testset, mean, <span class="kw">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##        mpg        cyl       disp         hp       drat         wt       qsec 
##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
##         vs         am       gear       carb      speed       dist 
##   0.437500   0.406250   3.687500   2.812500  15.400000  42.980000</code></pre>
</div>
<div id="homework-9" class="section level2">
<h2>Homework 9</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p><strong>Write an Rcpp function for Exercise 9.4 (page 277, Statistical Computing with R).</strong></p>
<p><strong>Compare the corresponding generated random numbers with those by the R function you wrote before using the function qqplot.</strong></p>
<p><strong>Compare the computation time of the two functions with the function “microbenchmark”.</strong></p>
<p><strong>Comment your results.</strong></p>
</div>
<div id="answer-26" class="section level2">
<h2>Answer</h2>
<p><strong>Using Rcpp function rwRcpp</strong></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a><span class="kw">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Rcpp&#39;是用R版本4.0.3 来建造的</code></pre>
<p><strong>Using R function rw.R</strong></p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a>rw.R &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb119-2"><a href="#cb119-2"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb119-3"><a href="#cb119-3"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb119-4"><a href="#cb119-4"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb119-5"><a href="#cb119-5"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb119-6"><a href="#cb119-6"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb119-7"><a href="#cb119-7"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb119-8"><a href="#cb119-8"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="kw">abs</span>(y)))) x[i] &lt;-<span class="st"> </span>y </span>
<span id="cb119-9"><a href="#cb119-9"></a>    <span class="cf">else</span> {</span>
<span id="cb119-10"><a href="#cb119-10"></a>      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb119-11"><a href="#cb119-11"></a>      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb119-12"><a href="#cb119-12"></a>    }</span>
<span id="cb119-13"><a href="#cb119-13"></a>  }</span>
<span id="cb119-14"><a href="#cb119-14"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb119-15"><a href="#cb119-15"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a><span class="kw">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a>N &lt;-<span class="st"> </span><span class="dv">8000</span></span>
<span id="cb122-2"><a href="#cb122-2"></a>x0 &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb122-3"><a href="#cb122-3"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb122-4"><a href="#cb122-4"></a>sigma &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb122-5"><a href="#cb122-5"></a>ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rwR=</span><span class="kw">rw.R</span>(sigma, x0, N),<span class="dt">rwC=</span><span class="kw">rwRcpp</span>(sigma, x0, N))</span>
<span id="cb122-6"><a href="#cb122-6"></a><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr       lq   median      uq
## 1  rwR 18.62725 19.80465 24.5174
## 2  rwC  1.45145  1.50180  1.6310</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1"></a>rwR=<span class="kw">rw.R</span>(sigma, x0, N)</span>
<span id="cb124-2"><a href="#cb124-2"></a>rwC=<span class="kw">rwRcpp</span>(sigma, x0, N)</span>
<span id="cb124-3"><a href="#cb124-3"></a><span class="kw">qqplot</span>(rwR<span class="op">$</span>x,rwC<span class="op">$</span>x,<span class="dt">xlab =</span> <span class="st">&#39;rwR&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;rwRcpp&#39;</span>,<span class="dt">pch =</span> <span class="dv">20</span>)</span>
<span id="cb124-4"><a href="#cb124-4"></a><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAclBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OpA6kLY6kNtmAABmADpmZgBmZmZmtv+QOgCQZgCQkGaQtpCQ2/+2ZgC2kDq2/7a2///bkDrbkJDb/7bb/9vb////tmb/25D//7b//9v////BmSpfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAILklEQVR4nO2dbXujNhBFyTYk6YudNm4bt6HtYpv//xcLEmAHjK9GGoEc7vmQ+NlIGjgrjWRbQFaRm2RLH0DqUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAggLKg7G5YSpBuc/GgoCnazkNBVzkPLwoa8yn/UNCQQYKmoAHDGYyCLhnP8JzmLxivf+qfFNRxxQ6H2AWjodUeIQVZJjMPBY0G1+f3X6sXNMjMo3enaxc01DMu4NyS8vGoNBfMeOEzKuHclOJh6TfnCbJTrVwQtFOtWpCLnvUKwmOrK+jcYvAxxWxOGt3ZzwoFDSYudCBrEyTUszpBUj1rEyS1U61LkIeeFQnykWPqqRdcpDkYzlPPWgT5+1mHoAA/XoKO2zrQ43dpKL+44QTYqbwElQ/v9c/C/PRmNkFhenwEnXZv5vf+Vh867ewxffsIjRtEyNjqmhAXPL7arlNOnnzdvbKNfVF2L7zjBuC17hk1Ii7Y9aBiugeddr2WqVLRBQ3eVMwoqO4VjaEie5sse9z2f5vqZ3EFZd2Xf8F+fIbY9hx24uwX7kH9l6LhemKtg/ruNX8OOusIl2NaUS9o6LrZZJ6KI+iTDxU/X2qh+NmGTgeae6GokhamWr4WKbxdcUGnhWJRH5spVswyi41NqP0/RFoo1t3ruM2reQSNNSj204gLxdOuLhFd0BULquM46kKxHoVxBV11oJvn4i4U93lMQdcNKM8DkRaKrZZaZixBUwK058lIC8VuAJ52cQRNn772MsJHUDPBT76H0I57re6t3SraqywPQXYBZGfx+HFHFW9vVlFfhfokaTt6bq2DFOMOqt2sF2OZ7rMOsoNran5SjntZx1GP6irdY4jZBHx4CkpC8q9f4EaeZATVbuqDCPtSQyrIZZ9KnPfBkaZ51ebczjnSxwQBgv6ZJQe5nnIcPR6CivYNxuQSUDWuzE6M7elSQc2nZXahGLZSdBw0Tk1FSs9t67KCp11uVkJF/CTtvAUsqh+poON201j6KcvjxnU+2SyyH7mgZg20D3wjBuIKTjW6H09BgV9p3IwrOtHIdipfQXmsuNIzjWynSkuQ/Ezj+0lIkM95xvcjF3Qe9T4Lxamc4Xma6QmKEtf/HOP7SUBQmJ0EBdWjLFeL63t+0Zc/50jygm0eCt/lGpR4EhZkOW4D3837ntnQT5KCmk4U2INCM89MfnwENZ+4BvUeUdxhvTnlmIDigoFjSxp3UG1WOSaiR8G6C+Wzxf1UaWY5JqZfwSK7sftFNe5FlSX8LDiLSSvMP7psXHnBfXuYMwqaPTVfhBYXrKf4wM+jRXFN4cX0+Ai6uM5gjrhL9h4TXlzw4kqVWeIuqscrB4XtexHGXViPZw7CSVrrisOF7VSxPg9Su+JwcT9xBKldL7a0nSqSILUrDpf3cw89SBA4ArFykMoVhwl0oFgf2qtccZhABkrhW40bZRLwM7cgybomiQ6Ucg9Kwg8FwaNQL1g5fYMPm0tjgMXqQXgLLGpu8bcY/YGoFzSYzZ4hzX11Qe2Frd7NJeMn0SSdjp80BSXkJzFB2Sd0I3qSlKAE/SQlKEU/iQjKxuiG8ycFQVf0JONneUHJmmlZVFDKPadjSUH34CcdQbrN65GIIN3GNUkhB+m2rMzis1jqUBBgMUF3w0KCbrZ4I5b2n/zaUyge1CIFgRYpCLRIQaBFCgItUhBokYJAixQEWqSgrwgFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCqAo6vHT7zAU39Wwr9Q+ecsBcW7y5fCGpZG4ElLsenqag830/SvcHubWVmgdPoU3YHaddXbioz7F/IalUlfWxuT8dQ1FQ2V/Bcdw6C2or2S38jne6PDyZxzR9++hfSCrZC0udH/6gJ6jMNt2lvsXj746CukoiQW3V7lYjpeCeI3XZw7PoFiWqOagVVB+CIAeV4iFm2Xd9YC+4ZURdtvz291Zw3/UIgpo+LBbUjDXR3WdKeJODiUpFM6bhVTk9EQQ1l4yLBTXdQPLQk7JLzaXgvmKmrH3MpfOdSvQFmTEuFSRJt6aSb//pgtiADugLKtr9Ja75xFSyidY53fY3ESkEftqytu84p+oYSbry7UGu/b6/wcGtJzJOVbI32FhwiBmi5qC+nCRpncs2OdL9flupCDL3mHM86HYQP7z3LySVzIS50DT/FaEgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUB7kNQ90whjSd8CbkXQXnzS7aJUYe7EuS+s1CPNAUdX//IHn7M2z6zf/yvNSPYVaNFooK2tYlmo5PdT79hDxpw3G7sjsX9b4/fD8/vrRnJjjstUhX0Zn4cX/98+SibywdkG0MVSVhQtd8cfv739X2f27F1eMoXOJSUBRWPf+XV/pfdW5t8JHui1UhZ0OHl101V/PD83mXnvcKjcqWkLOi4NVe4mF27uf1nTvOW9mmK/ebpbn6XbKxXIk1BCUFBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQH+B82hYwcEGAl5AAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb125-2"><a href="#cb125-2"></a>sigma &lt;-<span class="st"> </span><span class="fl">.5</span></span>
<span id="cb125-3"><a href="#cb125-3"></a>ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rwR=</span><span class="kw">rw.R</span>(sigma, x0, N),<span class="dt">rwC=</span><span class="kw">rwRcpp</span>(sigma, x0, N))</span>
<span id="cb125-4"><a href="#cb125-4"></a><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr      lq   median       uq
## 1  rwR 17.8430 18.73315 24.32175
## 2  rwC  1.6452  1.66285  1.74555</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a>rwR=<span class="kw">rw.R</span>(sigma, x0, N);rwC=<span class="kw">rwRcpp</span>(sigma, x0, N)</span>
<span id="cb127-2"><a href="#cb127-2"></a><span class="kw">qqplot</span>(rwR<span class="op">$</span>x,rwC<span class="op">$</span>x,<span class="dt">xlab =</span> <span class="st">&#39;rwR&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;rwRcpp&#39;</span>,<span class="dt">pch =</span> <span class="dv">20</span>)</span>
<span id="cb127-3"><a href="#cb127-3"></a><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb128-2"><a href="#cb128-2"></a>sigma &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb128-3"><a href="#cb128-3"></a>ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rwR=</span><span class="kw">rw.R</span>(sigma, x0, N),<span class="dt">rwC=</span><span class="kw">rwRcpp</span>(sigma, x0, N))</span>
<span id="cb128-4"><a href="#cb128-4"></a><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr       lq   median       uq
## 1  rwR 17.87880 19.16395 24.54910
## 2  rwC  1.63385  1.65105  1.73965</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a>rwR=<span class="kw">rw.R</span>(sigma, x0, N);rwC=<span class="kw">rwRcpp</span>(sigma, x0, N)</span>
<span id="cb130-2"><a href="#cb130-2"></a><span class="kw">qqplot</span>(rwR<span class="op">$</span>x,rwC<span class="op">$</span>x,<span class="dt">xlab =</span> <span class="st">&#39;rwR&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;rwRcpp&#39;</span>,<span class="dt">pch =</span> <span class="dv">20</span>)</span>
<span id="cb130-3"><a href="#cb130-3"></a><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb131-2"><a href="#cb131-2"></a>sigma &lt;-<span class="st"> </span><span class="dv">16</span></span>
<span id="cb131-3"><a href="#cb131-3"></a>ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rwR=</span><span class="kw">rw.R</span>(sigma, x0, N),<span class="dt">rwC=</span><span class="kw">rwRcpp</span>(sigma, x0, N))</span>
<span id="cb131-4"><a href="#cb131-4"></a><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##   expr      lq   median       uq
## 1  rwR 17.9084 18.38470 24.10350
## 2  rwC  1.5383  1.54865  1.62295</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a>rwR=<span class="kw">rw.R</span>(sigma, x0, N);rwC=<span class="kw">rwRcpp</span>(sigma, x0, N)</span>
<span id="cb133-2"><a href="#cb133-2"></a><span class="kw">qqplot</span>(rwR<span class="op">$</span>x,rwC<span class="op">$</span>x,<span class="dt">xlab =</span> <span class="st">&#39;rwR&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;rwRcpp&#39;</span>,<span class="dt">pch =</span> <span class="dv">20</span>)</span>
<span id="cb133-3"><a href="#cb133-3"></a><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>The computation time using cpp function is always much less than the time using R function.\And the qqplot shows that when choosing a suitable <span class="math inline">\(\sigma\)</span> both random walk chains fit well.</strong></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
